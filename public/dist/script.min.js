!function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(){},{}],2:[function(require,module){module.exports="function"==typeof Object.create?function(ctor,superCtor){ctor.super_=superCtor,ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:!1,writable:!0,configurable:!0}})}:function(ctor,superCtor){ctor.super_=superCtor;var TempCtor=function(){};TempCtor.prototype=superCtor.prototype,ctor.prototype=new TempCtor,ctor.prototype.constructor=ctor}},{}],3:[function(require,module){var process=module.exports={};process.nextTick=function(){var canSetImmediate="undefined"!=typeof window&&window.setImmediate,canPost="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(canSetImmediate)return function(f){return window.setImmediate(f)};if(canPost){var queue=[];return window.addEventListener("message",function(ev){var source=ev.source;if((source===window||null===source)&&"process-tick"===ev.data&&(ev.stopPropagation(),queue.length>0)){var fn=queue.shift();fn()}},!0),function(fn){queue.push(fn),window.postMessage("process-tick","*")}}return function(fn){setTimeout(fn,0)}}(),process.title="browser",process.browser=!0,process.env={},process.argv=[],process.binding=function(){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(){throw new Error("process.chdir is not supported")}},{}],4:[function(require,module,exports){(function(process){function normalizeArray(parts,allowAboveRoot){for(var up=0,i=parts.length-1;i>=0;i--){var last=parts[i];"."===last?parts.splice(i,1):".."===last?(parts.splice(i,1),up++):up&&(parts.splice(i,1),up--)}if(allowAboveRoot)for(;up--;up)parts.unshift("..");return parts}function filter(xs,f){if(xs.filter)return xs.filter(f);for(var res=[],i=0;i<xs.length;i++)f(xs[i],i,xs)&&res.push(xs[i]);return res}var splitPathRe=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,splitPath=function(filename){return splitPathRe.exec(filename).slice(1)};exports.resolve=function(){for(var resolvedPath="",resolvedAbsolute=!1,i=arguments.length-1;i>=-1&&!resolvedAbsolute;i--){var path=i>=0?arguments[i]:process.cwd();if("string"!=typeof path)throw new TypeError("Arguments to path.resolve must be strings");path&&(resolvedPath=path+"/"+resolvedPath,resolvedAbsolute="/"===path.charAt(0))}return resolvedPath=normalizeArray(filter(resolvedPath.split("/"),function(p){return!!p}),!resolvedAbsolute).join("/"),(resolvedAbsolute?"/":"")+resolvedPath||"."},exports.normalize=function(path){var isAbsolute=exports.isAbsolute(path),trailingSlash="/"===substr(path,-1);return path=normalizeArray(filter(path.split("/"),function(p){return!!p}),!isAbsolute).join("/"),path||isAbsolute||(path="."),path&&trailingSlash&&(path+="/"),(isAbsolute?"/":"")+path},exports.isAbsolute=function(path){return"/"===path.charAt(0)},exports.join=function(){var paths=Array.prototype.slice.call(arguments,0);return exports.normalize(filter(paths,function(p){if("string"!=typeof p)throw new TypeError("Arguments to path.join must be strings");return p}).join("/"))},exports.relative=function(from,to){function trim(arr){for(var start=0;start<arr.length&&""===arr[start];start++);for(var end=arr.length-1;end>=0&&""===arr[end];end--);return start>end?[]:arr.slice(start,end-start+1)}from=exports.resolve(from).substr(1),to=exports.resolve(to).substr(1);for(var fromParts=trim(from.split("/")),toParts=trim(to.split("/")),length=Math.min(fromParts.length,toParts.length),samePartsLength=length,i=0;length>i;i++)if(fromParts[i]!==toParts[i]){samePartsLength=i;break}for(var outputParts=[],i=samePartsLength;i<fromParts.length;i++)outputParts.push("..");return outputParts=outputParts.concat(toParts.slice(samePartsLength)),outputParts.join("/")},exports.sep="/",exports.delimiter=":",exports.dirname=function(path){var result=splitPath(path),root=result[0],dir=result[1];return root||dir?(dir&&(dir=dir.substr(0,dir.length-1)),root+dir):"."},exports.basename=function(path,ext){var f=splitPath(path)[2];return ext&&f.substr(-1*ext.length)===ext&&(f=f.substr(0,f.length-ext.length)),f},exports.extname=function(path){return splitPath(path)[3]};var substr="b"==="ab".substr(-1)?function(str,start,len){return str.substr(start,len)}:function(str,start,len){return 0>start&&(start=str.length+start),str.substr(start,len)}}).call(this,require("c:\\Users\\Mosho\\Documents\\GitHub\\DL-Shade2\\DL-Shade\\node_modules\\grunt-browserify\\node_modules\\browserify\\node_modules\\insert-module-globals\\node_modules\\process\\browser.js"))},{"c:\\Users\\Mosho\\Documents\\GitHub\\DL-Shade2\\DL-Shade\\node_modules\\grunt-browserify\\node_modules\\browserify\\node_modules\\insert-module-globals\\node_modules\\process\\browser.js":3}],5:[function(require,module){module.exports=function(arg){return arg&&"object"==typeof arg&&"function"==typeof arg.copy&&"function"==typeof arg.fill&&"function"==typeof arg.readUInt8}},{}],6:[function(require,module,exports){(function(process,global){function inspect(obj,opts){var ctx={seen:[],stylize:stylizeNoColor};return arguments.length>=3&&(ctx.depth=arguments[2]),arguments.length>=4&&(ctx.colors=arguments[3]),isBoolean(opts)?ctx.showHidden=opts:opts&&exports._extend(ctx,opts),isUndefined(ctx.showHidden)&&(ctx.showHidden=!1),isUndefined(ctx.depth)&&(ctx.depth=2),isUndefined(ctx.colors)&&(ctx.colors=!1),isUndefined(ctx.customInspect)&&(ctx.customInspect=!0),ctx.colors&&(ctx.stylize=stylizeWithColor),formatValue(ctx,obj,ctx.depth)}function stylizeWithColor(str,styleType){var style=inspect.styles[styleType];return style?"["+inspect.colors[style][0]+"m"+str+"["+inspect.colors[style][1]+"m":str}function stylizeNoColor(str){return str}function arrayToHash(array){var hash={};return array.forEach(function(val){hash[val]=!0}),hash}function formatValue(ctx,value,recurseTimes){if(ctx.customInspect&&value&&isFunction(value.inspect)&&value.inspect!==exports.inspect&&(!value.constructor||value.constructor.prototype!==value)){var ret=value.inspect(recurseTimes,ctx);return isString(ret)||(ret=formatValue(ctx,ret,recurseTimes)),ret}var primitive=formatPrimitive(ctx,value);if(primitive)return primitive;var keys=Object.keys(value),visibleKeys=arrayToHash(keys);if(ctx.showHidden&&(keys=Object.getOwnPropertyNames(value)),isError(value)&&(keys.indexOf("message")>=0||keys.indexOf("description")>=0))return formatError(value);if(0===keys.length){if(isFunction(value)){var name=value.name?": "+value.name:"";return ctx.stylize("[Function"+name+"]","special")}if(isRegExp(value))return ctx.stylize(RegExp.prototype.toString.call(value),"regexp");if(isDate(value))return ctx.stylize(Date.prototype.toString.call(value),"date");if(isError(value))return formatError(value)}var base="",array=!1,braces=["{","}"];if(isArray(value)&&(array=!0,braces=["[","]"]),isFunction(value)){var n=value.name?": "+value.name:"";base=" [Function"+n+"]"}if(isRegExp(value)&&(base=" "+RegExp.prototype.toString.call(value)),isDate(value)&&(base=" "+Date.prototype.toUTCString.call(value)),isError(value)&&(base=" "+formatError(value)),0===keys.length&&(!array||0==value.length))return braces[0]+base+braces[1];if(0>recurseTimes)return isRegExp(value)?ctx.stylize(RegExp.prototype.toString.call(value),"regexp"):ctx.stylize("[Object]","special");ctx.seen.push(value);var output;return output=array?formatArray(ctx,value,recurseTimes,visibleKeys,keys):keys.map(function(key){return formatProperty(ctx,value,recurseTimes,visibleKeys,key,array)}),ctx.seen.pop(),reduceToSingleString(output,base,braces)}function formatPrimitive(ctx,value){if(isUndefined(value))return ctx.stylize("undefined","undefined");if(isString(value)){var simple="'"+JSON.stringify(value).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return ctx.stylize(simple,"string")}return isNumber(value)?ctx.stylize(""+value,"number"):isBoolean(value)?ctx.stylize(""+value,"boolean"):isNull(value)?ctx.stylize("null","null"):void 0}function formatError(value){return"["+Error.prototype.toString.call(value)+"]"}function formatArray(ctx,value,recurseTimes,visibleKeys,keys){for(var output=[],i=0,l=value.length;l>i;++i)output.push(hasOwnProperty(value,String(i))?formatProperty(ctx,value,recurseTimes,visibleKeys,String(i),!0):"");return keys.forEach(function(key){key.match(/^\d+$/)||output.push(formatProperty(ctx,value,recurseTimes,visibleKeys,key,!0))}),output}function formatProperty(ctx,value,recurseTimes,visibleKeys,key,array){var name,str,desc;if(desc=Object.getOwnPropertyDescriptor(value,key)||{value:value[key]},desc.get?str=desc.set?ctx.stylize("[Getter/Setter]","special"):ctx.stylize("[Getter]","special"):desc.set&&(str=ctx.stylize("[Setter]","special")),hasOwnProperty(visibleKeys,key)||(name="["+key+"]"),str||(ctx.seen.indexOf(desc.value)<0?(str=isNull(recurseTimes)?formatValue(ctx,desc.value,null):formatValue(ctx,desc.value,recurseTimes-1),str.indexOf("\n")>-1&&(str=array?str.split("\n").map(function(line){return"  "+line}).join("\n").substr(2):"\n"+str.split("\n").map(function(line){return"   "+line}).join("\n"))):str=ctx.stylize("[Circular]","special")),isUndefined(name)){if(array&&key.match(/^\d+$/))return str;name=JSON.stringify(""+key),name.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(name=name.substr(1,name.length-2),name=ctx.stylize(name,"name")):(name=name.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),name=ctx.stylize(name,"string"))}return name+": "+str}function reduceToSingleString(output,base,braces){var numLinesEst=0,length=output.reduce(function(prev,cur){return numLinesEst++,cur.indexOf("\n")>=0&&numLinesEst++,prev+cur.replace(/\u001b\[\d\d?m/g,"").length+1},0);return length>60?braces[0]+(""===base?"":base+"\n ")+" "+output.join(",\n  ")+" "+braces[1]:braces[0]+base+" "+output.join(", ")+" "+braces[1]}function isArray(ar){return Array.isArray(ar)}function isBoolean(arg){return"boolean"==typeof arg}function isNull(arg){return null===arg}function isNullOrUndefined(arg){return null==arg}function isNumber(arg){return"number"==typeof arg}function isString(arg){return"string"==typeof arg}function isSymbol(arg){return"symbol"==typeof arg}function isUndefined(arg){return void 0===arg}function isRegExp(re){return isObject(re)&&"[object RegExp]"===objectToString(re)}function isObject(arg){return"object"==typeof arg&&null!==arg}function isDate(d){return isObject(d)&&"[object Date]"===objectToString(d)}function isError(e){return isObject(e)&&("[object Error]"===objectToString(e)||e instanceof Error)}function isFunction(arg){return"function"==typeof arg}function isPrimitive(arg){return null===arg||"boolean"==typeof arg||"number"==typeof arg||"string"==typeof arg||"symbol"==typeof arg||"undefined"==typeof arg}function objectToString(o){return Object.prototype.toString.call(o)}function pad(n){return 10>n?"0"+n.toString(10):n.toString(10)}function timestamp(){var d=new Date,time=[pad(d.getHours()),pad(d.getMinutes()),pad(d.getSeconds())].join(":");return[d.getDate(),months[d.getMonth()],time].join(" ")}function hasOwnProperty(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)}var formatRegExp=/%[sdj%]/g;exports.format=function(f){if(!isString(f)){for(var objects=[],i=0;i<arguments.length;i++)objects.push(inspect(arguments[i]));return objects.join(" ")}for(var i=1,args=arguments,len=args.length,str=String(f).replace(formatRegExp,function(x){if("%%"===x)return"%";if(i>=len)return x;switch(x){case"%s":return String(args[i++]);case"%d":return Number(args[i++]);case"%j":try{return JSON.stringify(args[i++])}catch(_){return"[Circular]"}default:return x}}),x=args[i];len>i;x=args[++i])str+=isNull(x)||!isObject(x)?" "+x:" "+inspect(x);return str},exports.deprecate=function(fn,msg){function deprecated(){if(!warned){if(process.throwDeprecation)throw new Error(msg);process.traceDeprecation?console.trace(msg):console.error(msg),warned=!0}return fn.apply(this,arguments)}if(isUndefined(global.process))return function(){return exports.deprecate(fn,msg).apply(this,arguments)};if(process.noDeprecation===!0)return fn;var warned=!1;return deprecated};var debugEnviron,debugs={};exports.debuglog=function(set){if(isUndefined(debugEnviron)&&(debugEnviron=process.env.NODE_DEBUG||""),set=set.toUpperCase(),!debugs[set])if(new RegExp("\\b"+set+"\\b","i").test(debugEnviron)){var pid=process.pid;debugs[set]=function(){var msg=exports.format.apply(exports,arguments);console.error("%s %d: %s",set,pid,msg)}}else debugs[set]=function(){};return debugs[set]},exports.inspect=inspect,inspect.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},inspect.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},exports.isArray=isArray,exports.isBoolean=isBoolean,exports.isNull=isNull,exports.isNullOrUndefined=isNullOrUndefined,exports.isNumber=isNumber,exports.isString=isString,exports.isSymbol=isSymbol,exports.isUndefined=isUndefined,exports.isRegExp=isRegExp,exports.isObject=isObject,exports.isDate=isDate,exports.isError=isError,exports.isFunction=isFunction,exports.isPrimitive=isPrimitive,exports.isBuffer=require("./support/isBuffer");var months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];exports.log=function(){console.log("%s - %s",timestamp(),exports.format.apply(exports,arguments))},exports.inherits=require("inherits"),exports._extend=function(origin,add){if(!add||!isObject(add))return origin;for(var keys=Object.keys(add),i=keys.length;i--;)origin[keys[i]]=add[keys[i]];return origin}}).call(this,require("c:\\Users\\Mosho\\Documents\\GitHub\\DL-Shade2\\DL-Shade\\node_modules\\grunt-browserify\\node_modules\\browserify\\node_modules\\insert-module-globals\\node_modules\\process\\browser.js"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":5,"c:\\Users\\Mosho\\Documents\\GitHub\\DL-Shade2\\DL-Shade\\node_modules\\grunt-browserify\\node_modules\\browserify\\node_modules\\insert-module-globals\\node_modules\\process\\browser.js":3,inherits:2}],7:[function(require,module,exports){var ScopeManager=require("./scope-manager").ScopeManager,f=require("util").format,functions=require("./functions"),AstValidator=function(){this.scopeManager=new ScopeManager,_.bindAll(this,"validate","validateNode","inferExpressionType"),this.error=!1,this.closures=1,this.scopeManager.pushNamespace(functions,"f")};AstValidator.prototype.validate=function(ast){return _.find(ast,this.validateNode),this.error?(console.log("Compile error: "+this.error),!1):!0},AstValidator.prototype.inferExpressionType=function(node){var i=this.inferExpressionType,type={};switch(node._type){case"BracketBlock":type=i(node.expr);break;case"Math":case"Comparison":type=i(node.left);break;case"Closure":type=node.returnType;break;case"CallValue":case"CallVariable":var identifier=this.scopeManager.getIdentifier(node.name);type=identifier._inferredType;break;case"Long":case"Double":case"String":type=node._type;break;case"ClassInstantiation":type=node.name;break;case"Array":type="raDL"}return type},AstValidator.prototype.validateObjectReference=function(name){_.isArray(name)&&(name=name[0]);var node=this.scopeManager.getIdentifier(name.join("."));return node},AstValidator.prototype.validateNode=function(node){var identifier;switch(node._type){case"AssignVariable":identifier=this.scopeManager.getIdentifier(node.name),identifier?"AssignValue"==identifier._type||"ValueParameter"==identifier._type?this.error=f("Cannot redeclare value %s as a variable on line %d",node.name,node.lineNo):("Variable"==identifier.type||"VariableParameter"==identifier._type)&&(this.error=f("Cannot redeclare variable %s on line %d",node.name,node.lineNo)):(this.scopeManager.pushIdentifier(node.name,node),this.validateNode(node.expr));break;case"AssignValue":this.scopeManager.hasIdentifier(node.name)?this.error=f("Cannot redeclare %s as a value on line %d",node.name,node.lineNo):(this.scopeManager.pushIdentifier(node.name,node),this.validateNode(node.expr),node._inferredType=this.inferExpressionType(node.expr));break;case"SetVariable":identifier=this.scopeManager.getIdentifier(node.name),identifier||this.scopeManager.pushIdentifier(node.name,node),this.validateNode(node.expr),node._inferredType=this.inferExpressionType(node.expr);break;case"CallVariable":this.scopeManager.hasIdentifier(node.name[0])||(this.scopeManager.pushIdentifier(node.name[0],node),node._inferredType="null");break;case"Closure":this.closures+=1,this.scopeManager.createScope("closure"+this.closures),_.find(node.parameters,this.validateNode),_.find(node.body,this.validateNode),this.error||this.scopeManager.exitScope();break;case"ValueParameter":case"VariableParameter":this.scopeManager.hasIdentifier(node.name)?this.error=f("Cannot redefined a parameter with the same name %s on line %d",node.name,node.lineNo):this.scopeManager.pushIdentifier(node.name,node);break;case"CallFunction":this.validateObjectReference(node.name)||(identifier=this.scopeManager.getIdentifier(node.name[0]),identifier?/Closure|Function/!==identifier.expr._type&&(this.error=f("Cannot call %s as a function or closure on line %d",node.name,node.lineNo)):this.error=f("Call to undefined function %s on line %d",node.name,node.lineNo));break;case"BracketBlock":case"Print":this.validateNode(node.expr);break;case"Class":identifier=this.scopeManager.getIdentifier(node.name),identifier&&"Class"==identifier._type?this.error=f("Cannot redefine class %s on line %d",node.name,node.lineNo):"__GLOBAL__"!=this.scopeManager.currentScope.name?this.error=f("Y U define class %s out of global scope on line %d?",node.name,node.lineNo):(this.scopeManager.pushIdentifier(node.name,node),this.scopeManager.createScope(node.name),_.find(node.body,this.validateNode),this.scopeManager.exitScope());break;case"ClassInstantiation":break;case"Comparison":if(!this.validateNode(node.left)&&!this.validateNode(node.right)){var left=this.inferExpressionType(node.left),right=this.inferExpressionType(node.right);left._type!==right._type&&(this.error=f("Cannot compare type %s to type %s on line %d",left._type,right._type,node.lineNo))}break;case"Math":if(!this.validateNode(node.left)&&!this.validateNode(node.right)){var left=this.inferExpressionType(node.left),right=this.inferExpressionType(node.right);"+"==node.operator&&"String"==left._type&&"String"!=right._type?this.error=f("Cannot concatenate %s to String %s... on line %d",right._type,left.value.substring(0,5),node.lineNo):left._type!==right._type&&(this.error=f("Cannot perform mathematical operation '%s' with types %s and %s on line %d (Expected)",node.operator,left._type,right._type,node.lineNo))}break;case"Namespace":}return this.error?!0:!1},exports.AstValidator=AstValidator,exports.validate=function(ast){var validator=new AstValidator;return validator.validate(ast)}},{"./functions":11,"./scope-manager":18,util:6}],8:[function(require,module){var f=require("./functions"),CalcHandlers=function(that){return{getVariableValue:function(name){return _name=name.join("."),that&&that[_name]?that[_name].setValue?that[_name].setValue:that[_name].value:null},createArray:function(arr){for(var rv={},i=0;i<arr.length;i++)void 0!==arr[i]&&(rv[i]=arr[i]);return rv},callFunction:function(name,args){return f[name[1]].apply(null,args)}}};module.exports=CalcHandlers},{"./functions":11}],9:[function(require,module,exports){var parser=function(){function Parser(){this.yy={}}var parser={trace:function(){},yy:{},symbols_:{error:2,expressions:3,e:4,EOF:5,"+":6,"-":7,"*":8,"/":9,"^":10,"!":11,"%":12,"(":13,")":14,NUMBER:15,BOOLEAN:16,E:17,PI:18,variablecall:19,STRING:20,"{":21,csv:22,"}":23,",":24,objectref:25,arguments:26,IDENTIFIER:27,".":28,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",6:"+",7:"-",8:"*",9:"/",10:"^",11:"!",12:"%",13:"(",14:")",15:"NUMBER",16:"BOOLEAN",17:"E",18:"PI",20:"STRING",21:"{",23:"}",24:",",27:"IDENTIFIER",28:"."},productions_:[0,[3,2],[4,3],[4,3],[4,3],[4,3],[4,3],[4,2],[4,2],[4,2],[4,3],[4,1],[4,1],[4,1],[4,1],[4,1],[4,1],[4,3],[22,1],[22,3],[19,3],[19,4],[19,1],[25,1],[25,3],[26,1],[26,3]],performAction:function(yytext,yyleng,yylineno,yy,yystate,$$){var $0=$$.length-1;switch(yystate){case 1:return"undefined"!=typeof console?console.log():print($$[$0-1]),$$[$0-1];case 2:this.$=$$[$0-2]+$$[$0];break;case 3:this.$=$$[$0-2]-$$[$0];break;case 4:this.$=$$[$0-2]*$$[$0];break;case 5:this.$=$$[$0-2]/$$[$0];break;case 6:this.$=Math.pow($$[$0-2],$$[$0]);break;case 7:this.$=function fact(n){return 0==n?1:fact(n-1)*n}($$[$0-1]);break;case 8:this.$=$$[$0-1]/100;break;case 9:this.$=-$$[$0];break;case 10:this.$=$$[$0-1];break;case 11:this.$=Number(yytext);break;case 12:this.$="true"===yytext;break;case 13:this.$=Math.E;break;case 14:this.$=Math.PI;break;case 16:this.$=yytext.substring(1,yytext.length-1);break;case 17:this.$=yy.createArray($$[$0-1]);break;case 18:this.$=[$$[$0]];break;case 19:$$[$0-2].push($$[$0]),this.$=$$[$0-2];break;case 20:this.$=yy.callFunction($$[$0-2]);break;case 21:this.$=yy.callFunction($$[$0-3],$$[$0-1]);break;case 22:this.$=yy.getVariableValue($$[$0]);break;case 23:this.$=[$$[$0]];break;case 24:this.$=$$[$0-2],this.$.push($$[$0]);break;case 25:this.$=[$$[$0]];break;case 26:this.$=$$[$0-2],$$[$0-2].push($$[$0])}},table:[{3:1,4:2,7:[1,3],13:[1,4],15:[1,5],16:[1,6],17:[1,7],18:[1,8],19:9,20:[1,10],21:[1,11],25:12,27:[1,13]},{1:[3]},{5:[1,14],6:[1,15],7:[1,16],8:[1,17],9:[1,18],10:[1,19],11:[1,20],12:[1,21]},{4:22,7:[1,3],13:[1,4],15:[1,5],16:[1,6],17:[1,7],18:[1,8],19:9,20:[1,10],21:[1,11],25:12,27:[1,13]},{4:23,7:[1,3],13:[1,4],15:[1,5],16:[1,6],17:[1,7],18:[1,8],19:9,20:[1,10],21:[1,11],25:12,27:[1,13]},{5:[2,11],6:[2,11],7:[2,11],8:[2,11],9:[2,11],10:[2,11],11:[2,11],12:[2,11],14:[2,11],23:[2,11],24:[2,11]},{5:[2,12],6:[2,12],7:[2,12],8:[2,12],9:[2,12],10:[2,12],11:[2,12],12:[2,12],14:[2,12],23:[2,12],24:[2,12]},{5:[2,13],6:[2,13],7:[2,13],8:[2,13],9:[2,13],10:[2,13],11:[2,13],12:[2,13],14:[2,13],23:[2,13],24:[2,13]},{5:[2,14],6:[2,14],7:[2,14],8:[2,14],9:[2,14],10:[2,14],11:[2,14],12:[2,14],14:[2,14],23:[2,14],24:[2,14]},{5:[2,15],6:[2,15],7:[2,15],8:[2,15],9:[2,15],10:[2,15],11:[2,15],12:[2,15],14:[2,15],23:[2,15],24:[2,15]},{5:[2,16],6:[2,16],7:[2,16],8:[2,16],9:[2,16],10:[2,16],11:[2,16],12:[2,16],14:[2,16],23:[2,16],24:[2,16]},{4:25,7:[1,3],13:[1,4],15:[1,5],16:[1,6],17:[1,7],18:[1,8],19:9,20:[1,10],21:[1,11],22:24,25:12,27:[1,13]},{5:[2,22],6:[2,22],7:[2,22],8:[2,22],9:[2,22],10:[2,22],11:[2,22],12:[2,22],13:[1,26],14:[2,22],23:[2,22],24:[2,22],28:[1,27]},{5:[2,23],6:[2,23],7:[2,23],8:[2,23],9:[2,23],10:[2,23],11:[2,23],12:[2,23],13:[2,23],14:[2,23],23:[2,23],24:[2,23],28:[2,23]},{1:[2,1]},{4:28,7:[1,3],13:[1,4],15:[1,5],16:[1,6],17:[1,7],18:[1,8],19:9,20:[1,10],21:[1,11],25:12,27:[1,13]},{4:29,7:[1,3],13:[1,4],15:[1,5],16:[1,6],17:[1,7],18:[1,8],19:9,20:[1,10],21:[1,11],25:12,27:[1,13]},{4:30,7:[1,3],13:[1,4],15:[1,5],16:[1,6],17:[1,7],18:[1,8],19:9,20:[1,10],21:[1,11],25:12,27:[1,13]},{4:31,7:[1,3],13:[1,4],15:[1,5],16:[1,6],17:[1,7],18:[1,8],19:9,20:[1,10],21:[1,11],25:12,27:[1,13]},{4:32,7:[1,3],13:[1,4],15:[1,5],16:[1,6],17:[1,7],18:[1,8],19:9,20:[1,10],21:[1,11],25:12,27:[1,13]},{5:[2,7],6:[2,7],7:[2,7],8:[2,7],9:[2,7],10:[2,7],11:[2,7],12:[2,7],14:[2,7],23:[2,7],24:[2,7]},{5:[2,8],6:[2,8],7:[2,8],8:[2,8],9:[2,8],10:[2,8],11:[2,8],12:[2,8],14:[2,8],23:[2,8],24:[2,8]},{5:[2,9],6:[2,9],7:[2,9],8:[2,9],9:[2,9],10:[2,9],11:[2,9],12:[2,9],14:[2,9],23:[2,9],24:[2,9]},{6:[1,15],7:[1,16],8:[1,17],9:[1,18],10:[1,19],11:[1,20],12:[1,21],14:[1,33]},{23:[1,34],24:[1,35]},{6:[1,15],7:[1,16],8:[1,17],9:[1,18],10:[1,19],11:[1,20],12:[1,21],23:[2,18],24:[2,18]},{4:38,7:[1,3],13:[1,4],14:[1,36],15:[1,5],16:[1,6],17:[1,7],18:[1,8],19:9,20:[1,10],21:[1,11],25:12,26:37,27:[1,13]},{27:[1,39]},{5:[2,2],6:[2,2],7:[2,2],8:[1,17],9:[1,18],10:[1,19],11:[1,20],12:[1,21],14:[2,2],23:[2,2],24:[2,2]},{5:[2,3],6:[2,3],7:[2,3],8:[1,17],9:[1,18],10:[1,19],11:[1,20],12:[1,21],14:[2,3],23:[2,3],24:[2,3]},{5:[2,4],6:[2,4],7:[2,4],8:[2,4],9:[2,4],10:[1,19],11:[1,20],12:[1,21],14:[2,4],23:[2,4],24:[2,4]},{5:[2,5],6:[2,5],7:[2,5],8:[2,5],9:[2,5],10:[1,19],11:[1,20],12:[1,21],14:[2,5],23:[2,5],24:[2,5]},{5:[2,6],6:[2,6],7:[2,6],8:[2,6],9:[2,6],10:[2,6],11:[1,20],12:[1,21],14:[2,6],23:[2,6],24:[2,6]},{5:[2,10],6:[2,10],7:[2,10],8:[2,10],9:[2,10],10:[2,10],11:[2,10],12:[2,10],14:[2,10],23:[2,10],24:[2,10]},{5:[2,17],6:[2,17],7:[2,17],8:[2,17],9:[2,17],10:[2,17],11:[2,17],12:[2,17],14:[2,17],23:[2,17],24:[2,17]},{4:40,7:[1,3],13:[1,4],15:[1,5],16:[1,6],17:[1,7],18:[1,8],19:9,20:[1,10],21:[1,11],25:12,27:[1,13]},{5:[2,20],6:[2,20],7:[2,20],8:[2,20],9:[2,20],10:[2,20],11:[2,20],12:[2,20],14:[2,20],23:[2,20],24:[2,20]},{14:[1,41],24:[1,42]},{6:[1,15],7:[1,16],8:[1,17],9:[1,18],10:[1,19],11:[1,20],12:[1,21],14:[2,25],24:[2,25]},{5:[2,24],6:[2,24],7:[2,24],8:[2,24],9:[2,24],10:[2,24],11:[2,24],12:[2,24],13:[2,24],14:[2,24],23:[2,24],24:[2,24],28:[2,24]},{6:[1,15],7:[1,16],8:[1,17],9:[1,18],10:[1,19],11:[1,20],12:[1,21],23:[2,19],24:[2,19]},{5:[2,21],6:[2,21],7:[2,21],8:[2,21],9:[2,21],10:[2,21],11:[2,21],12:[2,21],14:[2,21],23:[2,21],24:[2,21]},{4:43,7:[1,3],13:[1,4],15:[1,5],16:[1,6],17:[1,7],18:[1,8],19:9,20:[1,10],21:[1,11],25:12,27:[1,13]},{6:[1,15],7:[1,16],8:[1,17],9:[1,18],10:[1,19],11:[1,20],12:[1,21],14:[2,26],24:[2,26]}],defaultActions:{14:[2,1]},parseError:function(str,hash){if(!hash.recoverable)throw new Error(str);this.trace(str)},parse:function(input){function lex(){var token;return token=self.lexer.lex()||EOF,"number"!=typeof token&&(token=self.symbols_[token]||token),token}var self=this,stack=[0],vstack=[null],lstack=[],table=this.table,yytext="",yylineno=0,yyleng=0,recovering=0,TERROR=2,EOF=1,args=lstack.slice.call(arguments,1);this.lexer.setInput(input),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,"undefined"==typeof this.lexer.yylloc&&(this.lexer.yylloc={});var yyloc=this.lexer.yylloc;lstack.push(yyloc);var ranges=this.lexer.options&&this.lexer.options.ranges;this.parseError="function"==typeof this.yy.parseError?this.yy.parseError:Object.getPrototypeOf(this).parseError;for(var symbol,preErrorSymbol,state,action,r,p,len,newState,expected,yyval={};;){if(state=stack[stack.length-1],this.defaultActions[state]?action=this.defaultActions[state]:((null===symbol||"undefined"==typeof symbol)&&(symbol=lex()),action=table[state]&&table[state][symbol]),"undefined"==typeof action||!action.length||!action[0]){var errStr="";expected=[];for(p in table[state])this.terminals_[p]&&p>TERROR&&expected.push("'"+this.terminals_[p]+"'");errStr=this.lexer.showPosition?"Parse error on line "+(yylineno+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+expected.join(", ")+", got '"+(this.terminals_[symbol]||symbol)+"'":"Parse error on line "+(yylineno+1)+": Unexpected "+(symbol==EOF?"end of input":"'"+(this.terminals_[symbol]||symbol)+"'"),this.parseError(errStr,{text:this.lexer.match,token:this.terminals_[symbol]||symbol,line:this.lexer.yylineno,loc:yyloc,expected:expected})}if(action[0]instanceof Array&&action.length>1)throw new Error("Parse Error: multiple actions possible at state: "+state+", token: "+symbol);switch(action[0]){case 1:stack.push(symbol),vstack.push(this.lexer.yytext),lstack.push(this.lexer.yylloc),stack.push(action[1]),symbol=null,preErrorSymbol?(symbol=preErrorSymbol,preErrorSymbol=null):(yyleng=this.lexer.yyleng,yytext=this.lexer.yytext,yylineno=this.lexer.yylineno,yyloc=this.lexer.yylloc,recovering>0&&recovering--);break;case 2:if(len=this.productions_[action[1]][1],yyval.$=vstack[vstack.length-len],yyval._$={first_line:lstack[lstack.length-(len||1)].first_line,last_line:lstack[lstack.length-1].last_line,first_column:lstack[lstack.length-(len||1)].first_column,last_column:lstack[lstack.length-1].last_column},ranges&&(yyval._$.range=[lstack[lstack.length-(len||1)].range[0],lstack[lstack.length-1].range[1]]),r=this.performAction.apply(yyval,[yytext,yyleng,yylineno,this.yy,action[1],vstack,lstack].concat(args)),"undefined"!=typeof r)return r;len&&(stack=stack.slice(0,-1*len*2),vstack=vstack.slice(0,-1*len),lstack=lstack.slice(0,-1*len)),stack.push(this.productions_[action[1]][0]),vstack.push(yyval.$),lstack.push(yyval._$),newState=table[stack[stack.length-2]][stack[stack.length-1]],stack.push(newState);break;case 3:return!0}}return!0}},lexer=function(){var lexer={EOF:1,parseError:function(str,hash){if(!this.yy.parser)throw new Error(str);this.yy.parser.parseError(str,hash)},setInput:function(input){return this._input=input,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var ch=this._input[0];this.yytext+=ch,this.yyleng++,this.offset++,this.match+=ch,this.matched+=ch;var lines=ch.match(/(?:\r\n?|\n).*/g);return lines?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),ch},unput:function(ch){var len=ch.length,lines=ch.split(/(?:\r\n?|\n)/g);this._input=ch+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-len-1),this.offset-=len;var oldLines=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),lines.length-1&&(this.yylineno-=lines.length-1);var r=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:lines?(lines.length===oldLines.length?this.yylloc.first_column:0)+oldLines[oldLines.length-lines.length].length-lines[0].length:this.yylloc.first_column-len},this.options.ranges&&(this.yylloc.range=[r[0],r[0]+this.yyleng-len]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function(n){this.unput(this.match.slice(n))},pastInput:function(){var past=this.matched.substr(0,this.matched.length-this.match.length);return(past.length>20?"...":"")+past.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var next=this.match;return next.length<20&&(next+=this._input.substr(0,20-next.length)),(next.substr(0,20)+(next.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var pre=this.pastInput(),c=new Array(pre.length+1).join("-");return pre+this.upcomingInput()+"\n"+c+"^"},test_match:function(match,indexed_rule){var token,lines,backup;if(this.options.backtrack_lexer&&(backup={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(backup.yylloc.range=this.yylloc.range.slice(0))),lines=match[0].match(/(?:\r\n?|\n).*/g),lines&&(this.yylineno+=lines.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:lines?lines[lines.length-1].length-lines[lines.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+match[0].length},this.yytext+=match[0],this.match+=match[0],this.matches=match,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(match[0].length),this.matched+=match[0],token=this.performAction.call(this,this.yy,this,indexed_rule,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),token)return token;
if(this._backtrack){for(var k in backup)this[k]=backup[k];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var token,match,tempMatch,index;this._more||(this.yytext="",this.match="");for(var rules=this._currentRules(),i=0;i<rules.length;i++)if(tempMatch=this._input.match(this.rules[rules[i]]),tempMatch&&(!match||tempMatch[0].length>match[0].length)){if(match=tempMatch,index=i,this.options.backtrack_lexer){if(token=this.test_match(tempMatch,rules[i]),token!==!1)return token;if(this._backtrack){match=!1;continue}return!1}if(!this.options.flex)break}return match?(token=this.test_match(match,rules[index]),token!==!1?token:!1):""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var r=this.next();return r?r:this.lex()},begin:function(condition){this.conditionStack.push(condition)},popState:function(){var n=this.conditionStack.length-1;return n>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(n){return n=this.conditionStack.length-1-Math.abs(n||0),n>=0?this.conditionStack[n]:"INITIAL"},pushState:function(condition){this.begin(condition)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(yy,yy_,$avoiding_name_collisions,YY_START){switch($avoiding_name_collisions){case 0:break;case 1:return 15;case 2:return 16;case 3:return 27;case 4:return 20;case 5:return 8;case 6:return 9;case 7:return 7;case 8:return 6;case 9:return 10;case 10:return 11;case 11:return 12;case 12:return 13;case 13:return 14;case 14:return 21;case 15:return 23;case 16:return 24;case 17:return 28;case 18:return 18;case 19:return 17;case 20:return 5;case 21:return"INVALID"}},rules:[/^(?:\s+)/,/^(?:[0-9]+(\.[0-9]+)?\b)/,/^(?:true|false\b)/,/^(?:(\$|[a-z])([a-z0-9_$])*)/,/^(?:('|")(\\.|[^\"])*('|"))/,/^(?:\*)/,/^(?:\/)/,/^(?:-)/,/^(?:\+)/,/^(?:\^)/,/^(?:!)/,/^(?:%)/,/^(?:\()/,/^(?:\))/,/^(?:\{)/,/^(?:\})/,/^(?:,)/,/^(?:\.)/,/^(?:PI\b)/,/^(?:E\b)/,/^(?:$)/,/^(?:.)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21],inclusive:!0}}};return lexer}();return parser.lexer=lexer,Parser.prototype=parser,parser.Parser=Parser,new Parser}();exports.parser=parser},{}],10:[function(require,module,exports){var parser=require("./parser").parser,nodes=require("./nodes"),lexer=require("./lexer"),jsCompiler=(require("./ast-validator"),require("./js-compiler"));parser.yy=nodes,parser.lexer={lex:function(){var token=this.tokens[this.pos]?this.tokens[this.pos++]:["EOF"];return this.yytext=token[1],this.yylineno=token[2],token[0]},setInput:function(tokens){this.tokens=tokens,this.pos=0},upcomingInput:function(){return""}},exports.parser=parser,exports.compile=function(code){var tokens=lexer.tokenise(code),ast=parser.parse(tokens),js=jsCompiler.compile(ast);return js}},{"./ast-validator":7,"./js-compiler":13,"./lexer":14,"./nodes":16,"./parser":17}],11:[function(require,module){var f={a2l:function(arr,delim){return _.isArray(arr)?arr.join(delim):void 0},abs:function(num){return _.isFinite(num)?Math.abs(num):void 0},avg:function(){var i,avg=0,num=0,len=arguments.length;for(i=0;i<arguments.length;i++)num=Number(arguments[i]),isNaN(num)?len--:avg+=num;return avg/len}};module.exports=f},{}],12:[function(require){(function(global){var compiler=require("./compiler"),Graph=(require("./variable-registry.js").VariableRegistry,function(data){this.initialise.apply(this,arguments),this.variables="string"==typeof data?compiler.compile(data).sortDependencies():{}});Graph.prototype={initialise:function(){_.bindAll(this)},set:function(name,value){this.variables.set(name,value)},unset:function(name){this.variables.unset(name)},evaluate:function(){return this.variables.evaluate(),this},get:function(){}},global.DL=global.DL||{},global.DL.createGraph=function(data){return new Graph(data)},global.DL.tokens=require("./lexer").tokenise,global.DL.builtInFunctions=Object.keys(require("./functions")).map(function(elm){return"f."+elm})}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./compiler":10,"./functions":11,"./lexer":14,"./variable-registry.js":20}],13:[function(require,module,exports){var VariableRegistry=(require("./scope-manager").ScopeManager,require("./variable-registry.js").VariableRegistry),VariableEntry=require("./variable-registry.js").VariableEntry,NodeHandlers=require("./node-handlers"),JsCompiler=function(){this.variableRegistry=new VariableRegistry,this.currentNamespace="",this.currentVariable=new VariableEntry,_.bindAll(this)};JsCompiler.prototype.compile=function(ast){return _.each(ast,function(node){this.compileNode(node),this.currentVariable=new VariableEntry},this),this.variableRegistry},JsCompiler.prototype.addNode=function(){},JsCompiler.prototype.compileNode=function(node){return NodeHandlers[node._type].call(this,node)},exports.compile=function(ast){var compiler=new JsCompiler;return compiler.compile(ast)}},{"./node-handlers":15,"./scope-manager":18,"./variable-registry.js":20}],14:[function(require,module,exports){var LONG=/^[0-9]+/,DOUBLE=/^[0-9]+\.[0-9]+/,STRING=/^(\'|\")(\\.|[^\"])*(\'|\")/,WHITESPACE=/^[^\n\S]+/,KEYWORD=/^([a-z]+)/gi,IDENTIFIER=/^(([a-z])([a-z0-9_$])*)/gi,TERMINATOR=/^(\n|;)/,MULTILINE_COMMENT=/^\/\*([^*]|[\r\n]|(\*+([^*\/]|[\r\n])))*\*+\//gm,SINGLELINE_COMMENT=/^((\/\/|#)).*$/,KEYWORDS=["print","var","val","if","else","fun","class","public","new"],SYNTAX=["{","}","(",")","[","]","!",".",",",":","?","@","$cx"],LITERALS={COMPARE:["===","!==","==","!=","<=",">=","<",">"],BOOLOP:["||","&&"],BOOLEAN:["true","false"],ASSIGN:["="],MATH:["*","/","^","%","+","-"]},Lexer=function(){};Lexer.prototype={tokenise:function(code){this.lineNo=0;var chunk,token,tokens=[],i=0;for(chunk=code.substring(i);i<code.length;)chunk=code.substring(i),token=this.whitespace(chunk),2!==token.length?(token=this.comments(chunk),2!=token.length?(token=this.literals(chunk),2!==token.length?(token=this.keyword(chunk),2!==token.length?(token=this.identifier(chunk),2!==token.length?(token=this.terminator(chunk),2!==token.length?(token=this.syntax(chunk),2!==token.length?(token=this.string(chunk),2!==token.length?(token=this.long(chunk),2!==token.length?(token=this.double(chunk),2!==token.length?(token=this.boolean(chunk),2!==token.length?(console.log("Could not match chunk starting with "+chunk[0]+"...skipping"),i+=1):(i+=token[1].length,token[2]=this.lineNo,tokens.push(token))):(i+=token[1].length,token[2]=this.lineNo,tokens.push(token))):(i+=token[1].length,token[2]=this.lineNo,tokens.push(token))):(i+=token[1].length,token[2]=this.lineNo,tokens.push(token))):(i+=token[1].length,token[2]=this.lineNo,tokens.push(token))):(i+=token[1].length,token[2]=this.lineNo,0!=tokens.length&&tokens.push(token),"\n"==token[1]&&(this.lineNo+=1))):(i+=token[1].length,token[2]=this.lineNo,tokens.push(token))):(i+=token[1].length,token[2]=this.lineNo,tokens.push(token))):(i+=token[1].length,token[2]=this.lineNo,tokens.push(token))):(i+=token[1].length,this.lineNo=token[1].split("\n").length-1)):i+=token[1].length;return tokens.push(["EOF","",this.lineNo]),tokens},syntax:function(chunk){var token=[];return _.find(SYNTAX,function(syntax){return 0===chunk.indexOf(syntax)?(token=[syntax,syntax],!0):void 0},this),token},comments:function(chunk){var token=[];return _.find([SINGLELINE_COMMENT,MULTILINE_COMMENT],function(regex){if(0===chunk.search(regex)){var result=chunk.match(regex)[0];return token=["COMMENT",result],!0}}),token},keyword:function(chunk){if(0===chunk.search(KEYWORD)){var result=chunk.match(KEYWORD)[0],index=KEYWORDS.indexOf(result);if(-1!==index)return[result.toUpperCase(),result]}return[]},identifier:function(chunk){if(0===chunk.search(IDENTIFIER)){var result=chunk.match(IDENTIFIER)[0];return["IDENTIFIER",result]}return[]},whitespace:function(chunk){if(0===chunk.search(WHITESPACE)){var result=chunk.match(WHITESPACE)[0];return["WHITESPACE",result]}return[]},"long":function(chunk){if(0===chunk.search(LONG)){var result=chunk.match(LONG)[0];return["LONG",result]}return[]},"double":function(chunk){if(0===chunk.search(DOUBLE)){var result=chunk.match(DOUBLE)[0];return["DOUBLE",result]}return[]},"boolean":function(chunk){if(0===chunk.search(BOOLEAN)){var result=chunk.match(BOOLEAN)[0];return["BOOLEAN",result]}return[]},literals:function(chunk){var token=[];return _(LITERALS).find(function(lits,name){return _(lits).find(function(lit){return 0===chunk.indexOf(lit)?(token=[name,lit],!0):void 0})}),token},string:function(chunk){if(0===chunk.search(STRING)){var result=chunk.match(STRING)[0];return["STRING",result]}return[]},terminator:function(chunk){return 0===chunk.search(TERMINATOR)?["TERMINATOR",chunk[0]]:[]}},exports.Lexer=Lexer,exports.tokenise=function(code){var lexer=new Lexer;return lexer.tokenise(code)}},{}],15:[function(require,module){var f=require("util").format,NodeHandlers={Math:function(node){return console.log(this),f("%s %s %s",this.compileNode(node.left),node.operator,this.compileNode(node.right))},Long:function(node){return node.value},Double:function(node){return node.value},String:function(node){return String(node.value)},Array:function(node){var list="{";return node.elements&&_.each(node.elements,function(element){list+=this.compileNode(element)+","},this),list=list.substring(0,list.length-1)+"}"},AssignVariable:function(node){return f("var %s = %s;",node.name,this.compileNode(node.expr))},SetVariable:function(node){this.currentVariable.name=this.currentNamespace+node.name,this.currentVariable.expr=this.compileNode(node.expr),this.variableRegistry.addToEntry(this.currentVariable)},CallVariable:function(node){var _name=node.name.join(".");return _name!==this.currentVariable.name&&-1===this.currentVariable.dependsOn.indexOf(_name)&&(this.currentVariable.dependsOn.push(node.name.join(".")),this.variableRegistry.addToEntry({name:node.name.join("."),dependedOnBy:[this.currentVariable.name]})),node.name.join||console.log(node),node.name.join(".")},Comparison:function(node){return f("%s %s %s",this.compileNode(node.left),node.comparator,this.compileNode(node.right))},CallFunction:function(node){var args=[];return node.args&&_.each(node.args,function(arg){args.push(this.compileNode(arg))},this),f("%s(%s)",node.name[0].join("."),args.join(", "))},Boolean:function(node){return node.value},Ternary:function(node){return f("%s ? %s : %s",this.compileNode(node.test),this.compileNode(node.equal),this.compileNode(node.nequal))},Namespace:function(ns){this.currentNamespace=ns.name+"."}};module.exports=NodeHandlers},{util:6}],16:[function(require,module){var Nodes={Math:function(left,right,operator){this._type="Math",this.left=left,this.right=right,this.operator=operator},Long:function(value){this._type="Long",this.value=value},Double:function(value){this._type="Double",this.value=value},String:function(value){this._type="String",this.value=value},Array:function(elements){this._type="Array",this.elements=elements},Print:function(expr){this._type="Print",this.expr=expr},BracketBlock:function(expr){this._type="BracketBlock",this.expr=expr},AssignVariable:function(name,expr,assignType){this._type="AssignVariable",this.name=name,this.expr=expr,this.assignType=assignType},AssignValue:function(name,expr,assignType){this._type="AssignValue",this.name=name,this.expr=expr,this.assignType=assignType},SetVariable:function(name,expr,assignType){this._type="SetVariable",this.name=name,this.expr=expr,this.assignType=assignType},CallVariable:function(name){this._type="CallVariable",this.name=name},Comparison:function(left,right,comparator){this._type="Comparison",this.left=left,this.right=right,this.comparator=comparator},VariableParameter:function(name,type){this._type="VariableParameter",this.name=name,this.type=type},CallFunction:function(name,args){this._type="CallFunction",this.name=[name],this.args=args||[]},Boolean:function(value){this._type="Boolean",this.value=value},Ternary:function(test,equal,nequal){this._type="Ternary",this.test=test,this.equal=equal,this.nequal=nequal},Namespace:function(ns){this._type="Namespace",this.name=ns}};module.exports=Nodes},{}],17:[function(require,module,exports){(function(process){var parser=function(){function Parser(){this.yy={}}var parser={trace:function(){},yy:{},symbols_:{error:2,program:3,EOF:4,body:5,line:6,TERMINATOR:7,PRINT:8,expr:9,classdef:10,assignment:11,ifblocks:12,IF:13,"(":14,")":15,block:16,ELSE:17,elseifs:18,"{":19,"}":20,VAR:21,IDENTIFIER:22,ASSIGN:23,VAL:24,MATH:25,COMPARE:26,BOOLOP:27,TERNARY:28,":":29,closure:30,instantiation:31,variablecall:32,type:33,namespace:34,$cx:35,parameters:36,parameter:37,",":38,arguments:39,FUN:40,CLASS:41,classbody:42,classline:43,method:44,PUBLIC:45,NEW:46,objectref:47,".":48,LONG:49,DOUBLE:50,STRING:51,BOOLEAN:52,csv:53,NULL:54,$accept:0,$end:1},terminals_:{2:"error",4:"EOF",7:"TERMINATOR",8:"PRINT",13:"IF",14:"(",15:")",17:"ELSE",19:"{",20:"}",21:"VAR",22:"IDENTIFIER",23:"ASSIGN",24:"VAL",25:"MATH",26:"COMPARE",27:"BOOLOP",28:"TERNARY",29:":",35:"$cx",38:",",40:"FUN",41:"CLASS",45:"PUBLIC",46:"NEW",48:".",49:"LONG",50:"DOUBLE",51:"STRING",52:"BOOLEAN",54:"NULL"},productions_:[0,[3,1],[3,2],[5,1],[5,3],[5,2],[5,1],[6,2],[6,1],[6,1],[6,1],[6,1],[12,5],[12,7],[12,6],[12,8],[18,6],[18,7],[16,2],[16,3],[11,4],[11,4],[11,3],[9,3],[9,3],[9,3],[9,3],[9,5],[9,1],[9,1],[9,1],[9,1],[9,1],[34,2],[36,1],[36,3],[37,3],[37,4],[37,4],[39,1],[39,3],[30,6],[30,7],[10,5],[42,1],[42,3],[42,2],[43,1],[44,8],[44,9],[31,4],[32,3],[32,4],[32,1],[47,1],[47,3],[33,1],[33,1],[33,1],[33,1],[33,3],[33,1],[53,1],[53,3]],performAction:function(yytext,yyleng,yylineno,yy,yystate,$$){var $0=$$.length-1;switch(yystate){case 1:break;case 2:return $$[$0-1];case 3:this.$=[$$[$0]];break;case 4:this.$=$$[$0-2],$$[$0-2].push($$[$0]);break;case 7:this.$=new yy.Print($$[$0]);break;case 12:this.$=new yy.IfBlock($$[$0-2],$$[$0]);break;case 13:this.$=new yy.IfBlock($$[$0-4],$$[$0-2],$$[$0]);break;case 14:this.$=new yy.IfBlock($$[$0-3],$$[$0-1],!1,$$[$0]);break;case 15:this.$=new yy.IfBlock($$[$0-5],$$[$0-3],$$[$0],$$[$0-2]);break;case 16:this.$=[new yy.ElseIfBlock($$[$0-2],$$[$0])];break;case 17:this.$=$$[$0-6],$$[$0-6].push(new yy.ElseIfBlock($$[$0-2],$$[$0]));break;case 18:this.$=[];break;case 19:this.$=$$[$0-1];break;case 20:this.$=new yy.AssignVariable($$[$0-2],$$[$0],$$[$0-1]);break;case 21:this.$=new yy.AssignValue($$[$0-2],$$[$0],$$[$0-1]);break;case 22:this.$=new yy.SetVariable($$[$0-2],$$[$0],$$[$0-1]);break;case 23:this.$=new yy.BracketBlock($$[$0-1]);break;case 24:this.$=new yy.Math($$[$0-2],$$[$0],$$[$0-1]);break;case 25:this.$=new yy.Comparison($$[$0-2],$$[$0],$$[$0-1]);break;case 26:this.$=new yy.Comparison($$[$0-2],$$[$0],$$[$0-1]);break;case 27:this.$=new yy.Ternary($$[$0-4],$$[$0-2],$$[$0]);break;case 33:this.$=new yy.Namespace($$[$0]);break;case 34:this.$=[$$[$0]];break;case 35:this.$=$$[$0-2],$$[$0-2].push($$[$0]);break;case 36:this.$=new yy.ValueParameter($$[$0-2],$$[$0]);break;case 37:this.$=new yy.ValueParameter($$[$0-2],$$[$0]);break;case 38:this.$=new yy.VariableParameter($$[$0-2],$$[$0]);break;case 39:this.$=[$$[$0]];break;case 40:this.$=$$[$0-2],$$[$0-2].push($$[$0]);break;case 41:this.$=new yy.Closure($$[$0],$$[$0-1]);break;case 42:this.$=new yy.Closure($$[$0],$$[$0-4],$$[$0-1]);break;case 43:this.$=new yy.Class($$[$0-3],$$[$0-1]);break;case 44:this.$=[$$[$0]];break;case 45:this.$=$$[$0-2],$$[$0-2].push($$[$0]);break;case 48:this.$=new yy.Method($$[$0-7],$$[$0-5],$$[$0]);break;case 49:this.$=new yy.Method($$[$0-8],$$[$0-6],$$[$0],$$[$0-4]);break;case 50:this.$=new yy.ClassInstantiation($$[$0-2]);break;case 51:this.$=new yy.CallFunction($$[$0-2]);break;case 52:this.$=new yy.CallFunction($$[$0-3],$$[$0-1]);break;case 53:this.$=new yy.CallVariable($$[$0]);break;case 54:this.$=[$$[$0]];break;case 55:this.$=$$[$0-2],this.$.push($$[$0]);break;case 56:this.$=new yy.Long($$[$0]);break;case 57:this.$=new yy.Double($$[$0]);break;case 58:this.$=new yy.String($$[$0]);break;case 59:this.$=new yy.Boolean($$[$0]);break;case 60:this.$=new yy.Array($$[$0-1]);break;case 61:this.$=new yy.Null($$[$0]);break;case 62:this.$=[$$[$0]];break;case 63:$$[$0-2].push($$[$0]),this.$=$$[$0-2]}},table:[{3:1,4:[1,2],5:3,6:4,7:[1,5],8:[1,6],9:10,10:7,11:8,12:9,13:[1,15],14:[1,16],19:[1,29],21:[1,12],22:[1,14],24:[1,13],30:17,31:18,32:19,33:20,34:21,35:[1,31],40:[1,22],41:[1,11],46:[1,23],47:24,49:[1,25],50:[1,26],51:[1,27],52:[1,28],54:[1,30]},{1:[3]},{1:[2,1]},{4:[1,32],7:[1,33]},{4:[2,3],7:[2,3],20:[2,3]},{4:[2,6],7:[2,6],20:[2,6]},{9:34,14:[1,16],19:[1,29],22:[1,35],30:17,31:18,32:19,33:20,34:21,35:[1,31],40:[1,22],46:[1,23],47:24,49:[1,25],50:[1,26],51:[1,27],52:[1,28],54:[1,30]},{4:[2,8],7:[2,8],20:[2,8]},{4:[2,9],7:[2,9],20:[2,9]},{4:[2,10],7:[2,10],20:[2,10]},{4:[2,11],7:[2,11],20:[2,11],25:[1,36],26:[1,37],27:[1,38],28:[1,39]},{22:[1,40]},{22:[1,41]},{22:[1,42]},{4:[2,54],7:[2,54],14:[2,54],20:[2,54],23:[1,43],25:[2,54],26:[2,54],27:[2,54],28:[2,54],48:[2,54]},{14:[1,44]},{9:45,14:[1,16],19:[1,29],22:[1,35],30:17,31:18,32:19,33:20,34:21,35:[1,31],40:[1,22],46:[1,23],47:24,49:[1,25],50:[1,26],51:[1,27],52:[1,28],54:[1,30]},{4:[2,28],7:[2,28],15:[2,28],20:[2,28],25:[2,28],26:[2,28],27:[2,28],28:[2,28],29:[2,28],38:[2,28]},{4:[2,29],7:[2,29],15:[2,29],20:[2,29],25:[2,29],26:[2,29],27:[2,29],28:[2,29],29:[2,29],38:[2,29]},{4:[2,30],7:[2,30],15:[2,30],20:[2,30],25:[2,30],26:[2,30],27:[2,30],28:[2,30],29:[2,30],38:[2,30]},{4:[2,31],7:[2,31],15:[2,31],20:[2,31],25:[2,31],26:[2,31],27:[2,31],28:[2,31],29:[2,31],38:[2,31]},{4:[2,32],7:[2,32],15:[2,32],20:[2,32],25:[2,32],26:[2,32],27:[2,32],28:[2,32],29:[2,32],38:[2,32]},{14:[1,46]},{22:[1,47]},{4:[2,53],7:[2,53],14:[1,48],15:[2,53],20:[2,53],25:[2,53],26:[2,53],27:[2,53],28:[2,53],29:[2,53],38:[2,53],48:[1,49]},{4:[2,56],7:[2,56],15:[2,56],20:[2,56],25:[2,56],26:[2,56],27:[2,56],28:[2,56],29:[2,56],38:[2,56]},{4:[2,57],7:[2,57],15:[2,57],20:[2,57],25:[2,57],26:[2,57],27:[2,57],28:[2,57],29:[2,57],38:[2,57]},{4:[2,58],7:[2,58],15:[2,58],20:[2,58],25:[2,58],26:[2,58],27:[2,58],28:[2,58],29:[2,58],38:[2,58]},{4:[2,59],7:[2,59],15:[2,59],20:[2,59],25:[2,59],26:[2,59],27:[2,59],28:[2,59],29:[2,59],38:[2,59]},{9:51,14:[1,16],19:[1,29],22:[1,35],30:17,31:18,32:19,33:20,34:21,35:[1,31],40:[1,22],46:[1,23],47:24,49:[1,25],50:[1,26],51:[1,27],52:[1,28],53:50,54:[1,30]},{4:[2,61],7:[2,61],15:[2,61],20:[2,61],25:[2,61],26:[2,61],27:[2,61],28:[2,61],29:[2,61],38:[2,61]},{22:[1,52]},{1:[2,2]},{4:[2,5],6:53,7:[2,5],8:[1,6],9:10,10:7,11:8,12:9,13:[1,15],14:[1,16],19:[1,29],20:[2,5],21:[1,12],22:[1,14],24:[1,13],30:17,31:18,32:19,33:20,34:21,35:[1,31],40:[1,22],41:[1,11],46:[1,23],47:24,49:[1,25],50:[1,26],51:[1,27],52:[1,28],54:[1,30]},{4:[2,7],7:[2,7],20:[2,7],25:[1,36],26:[1,37],27:[1,38],28:[1,39]},{4:[2,54],7:[2,54],14:[2,54],15:[2,54],20:[2,54],25:[2,54],26:[2,54],27:[2,54],28:[2,54],29:[2,54],38:[2,54],48:[2,54]},{9:54,14:[1,16],19:[1,29],22:[1,35],30:17,31:18,32:19,33:20,34:21,35:[1,31],40:[1,22],46:[1,23],47:24,49:[1,25],50:[1,26],51:[1,27],52:[1,28],54:[1,30]},{9:55,14:[1,16],19:[1,29],22:[1,35],30:17,31:18,32:19,33:20,34:21,35:[1,31],40:[1,22],46:[1,23],47:24,49:[1,25],50:[1,26],51:[1,27],52:[1,28],54:[1,30]},{9:56,14:[1,16],19:[1,29],22:[1,35],30:17,31:18,32:19,33:20,34:21,35:[1,31],40:[1,22],46:[1,23],47:24,49:[1,25],50:[1,26],51:[1,27],52:[1,28],54:[1,30]},{9:57,14:[1,16],19:[1,29],22:[1,35],30:17,31:18,32:19,33:20,34:21,35:[1,31],40:[1,22],46:[1,23],47:24,49:[1,25],50:[1,26],51:[1,27],52:[1,28],54:[1,30]},{19:[1,58]},{23:[1,59]},{23:[1,60]},{9:61,14:[1,16],19:[1,29],22:[1,35],30:17,31:18,32:19,33:20,34:21,35:[1,31],40:[1,22],46:[1,23],47:24,49:[1,25],50:[1,26],51:[1,27],52:[1,28],54:[1,30]},{9:62,14:[1,16],19:[1,29],22:[1,35],30:17,31:18,32:19,33:20,34:21,35:[1,31],40:[1,22],46:[1,23],47:24,49:[1,25],50:[1,26],51:[1,27],52:[1,28],54:[1,30]},{15:[1,63],25:[1,36],26:[1,37],27:[1,38],28:[1,39]},{15:[1,64],21:[1,69],22:[1,67],24:[1,68],36:65,37:66},{14:[1,70]},{9:73,14:[1,16],15:[1,71],19:[1,29],22:[1,35],30:17,31:18,32:19,33:20,34:21,35:[1,31],39:72,40:[1,22],46:[1,23],47:24,49:[1,25],50:[1,26],51:[1,27],52:[1,28],54:[1,30]},{22:[1,74]},{20:[1,75],38:[1,76]},{20:[2,62],25:[1,36],26:[1,37],27:[1,38],28:[1,39],38:[2,62]},{4:[2,33],7:[2,33],15:[2,33],20:[2,33],25:[2,33],26:[2,33],27:[2,33],28:[2,33],29:[2,33],38:[2,33]},{4:[2,4],7:[2,4],20:[2,4]},{4:[2,24],7:[2,24],15:[2,24],20:[2,24],25:[2,24],26:[2,24],27:[2,24],28:[2,24],29:[2,24],38:[2,24]},{4:[2,25],7:[2,25],15:[2,25],20:[2,25],25:[2,25],26:[2,25],27:[2,25],28:[2,25],29:[2,25],38:[2,25]},{4:[2,26],7:[2,26],15:[2,26],20:[2,26],25:[2,26],26:[2,26],27:[2,26],28:[2,26],29:[2,26],38:[2,26]},{25:[1,36],26:[1,37],27:[1,38],28:[1,39],29:[1,77]},{42:78,43:79,44:80,45:[1,81]},{9:82,14:[1,16],19:[1,29],22:[1,35],30:17,31:18,32:19,33:20,34:21,35:[1,31],40:[1,22],46:[1,23],47:24,49:[1,25],50:[1,26],51:[1,27],52:[1,28],54:[1,30]},{9:83,14:[1,16],19:[1,29],22:[1,35],30:17,31:18,32:19,33:20,34:21,35:[1,31],40:[1,22],46:[1,23],47:24,49:[1,25],50:[1,26],51:[1,27],52:[1,28],54:[1,30]},{4:[2,22],7:[2,22],20:[2,22],25:[1,36],26:[1,37],27:[1,38],28:[1,39]},{15:[1,84],25:[1,36],26:[1,37],27:[1,38],28:[1,39]},{4:[2,23],7:[2,23],15:[2,23],20:[2,23],25:[2,23],26:[2,23],27:[2,23],28:[2,23],29:[2,23],38:[2,23]},{29:[1,85]},{15:[1,86],38:[1,87]},{15:[2,34],38:[2,34]},{29:[1,88]},{22:[1,89]},{22:[1,90]},{15:[1,91]},{4:[2,51],7:[2,51],15:[2,51],20:[2,51],25:[2,51],26:[2,51],27:[2,51],28:[2,51],29:[2,51],38:[2,51]},{15:[1,92],38:[1,93]},{15:[2,39],25:[1,36],26:[1,37],27:[1,38],28:[1,39],38:[2,39]},{4:[2,55],7:[2,55],14:[2,55],15:[2,55],20:[2,55],25:[2,55],26:[2,55],27:[2,55],28:[2,55],29:[2,55],38:[2,55],48:[2,55]},{4:[2,60],7:[2,60],15:[2,60],20:[2,60],25:[2,60],26:[2,60],27:[2,60],28:[2,60],29:[2,60],38:[2,60]},{9:94,14:[1,16],19:[1,29],22:[1,35],30:17,31:18,32:19,33:20,34:21,35:[1,31],40:[1,22],46:[1,23],47:24,49:[1,25],50:[1,26],51:[1,27],52:[1,28],54:[1,30]},{9:95,14:[1,16],19:[1,29],22:[1,35],30:17,31:18,32:19,33:20,34:21,35:[1,31],40:[1,22],46:[1,23],47:24,49:[1,25],50:[1,26],51:[1,27],52:[1,28],54:[1,30]},{7:[1,97],20:[1,96]},{7:[2,44],20:[2,44]},{7:[2,47],20:[2,47]},{40:[1,98]},{4:[2,20],7:[2,20],20:[2,20],25:[1,36],26:[1,37],27:[1,38],28:[1,39]},{4:[2,21],7:[2,21],20:[2,21],25:[1,36],26:[1,37],27:[1,38],28:[1,39]},{16:99,19:[1,100]},{22:[1,101]},{29:[1,102]},{21:[1,69],22:[1,67],24:[1,68],37:103},{22:[1,104]},{29:[1,105]},{29:[1,106]},{4:[2,50],7:[2,50],15:[2,50],20:[2,50],25:[2,50],26:[2,50],27:[2,50],28:[2,50],29:[2,50],38:[2,50]},{4:[2,52],7:[2,52],15:[2,52],20:[2,52],25:[2,52],26:[2,52],27:[2,52],28:[2,52],29:[2,52],38:[2,52]},{9:107,14:[1,16],19:[1,29],22:[1,35],30:17,31:18,32:19,33:20,34:21,35:[1,31],40:[1,22],46:[1,23],47:24,49:[1,25],50:[1,26],51:[1,27],52:[1,28],54:[1,30]},{20:[2,63],25:[1,36],26:[1,37],27:[1,38],28:[1,39],38:[2,63]},{4:[2,27],7:[2,27],15:[2,27],20:[2,27],25:[2,27],26:[2,27],27:[2,27],28:[2,27],29:[2,27],38:[2,27]},{4:[2,43],7:[2,43],20:[2,43]},{7:[2,46],20:[2,46],43:108,44:80,45:[1,81]},{22:[1,109]},{4:[2,12],7:[2,12],17:[1,110],18:111,20:[2,12]},{5:113,6:4,7:[1,5],8:[1,6],9:10,10:7,11:8,12:9,13:[1,15],14:[1,16],19:[1,29],20:[1,112],21:[1,12],22:[1,14],24:[1,13],30:17,31:18,32:19,33:20,34:21,35:[1,31],40:[1,22],41:[1,11],46:[1,23],47:24,49:[1,25],50:[1,26],51:[1,27],52:[1,28],54:[1,30]},{16:114,19:[1,100]},{22:[1,115]},{15:[2,35],38:[2,35]},{15:[2,36],38:[2,36]},{22:[1,116]},{22:[1,117]},{15:[2,40],25:[1,36],26:[1,37],27:[1,38],28:[1,39],38:[2,40]},{7:[2,45],20:[2,45]},{14:[1,118]},{13:[1,120],16:119,19:[1,100]},{4:[2,14],7:[2,14],17:[1,121],20:[2,14]},{4:[2,18],7:[2,18],15:[2,18],17:[2,18],20:[2,18],25:[2,18],26:[2,18],27:[2,18],28:[2,18],29:[2,18],38:[2,18]},{7:[1,33],20:[1,122]},{4:[2,41],7:[2,41],15:[2,41],20:[2,41],25:[2,41],26:[2,41],27:[2,41],28:[2,41],29:[2,41],38:[2,41]},{16:123,19:[1,100]},{15:[2,37],38:[2,37]},{15:[2,38],38:[2,38]},{15:[1,124],21:[1,69],22:[1,67],24:[1,68],36:125,37:66},{4:[2,13],7:[2,13],20:[2,13]},{14:[1,126]},{13:[1,128],16:127,19:[1,100]},{4:[2,19],7:[2,19],15:[2,19],17:[2,19],20:[2,19],25:[2,19],26:[2,19],27:[2,19],28:[2,19],29:[2,19],38:[2,19]},{4:[2,42],7:[2,42],15:[2,42],20:[2,42],25:[2,42],26:[2,42],27:[2,42],28:[2,42],29:[2,42],38:[2,42]},{29:[1,129]},{15:[1,130],38:[1,87]},{9:131,14:[1,16],19:[1,29],22:[1,35],30:17,31:18,32:19,33:20,34:21,35:[1,31],40:[1,22],46:[1,23],47:24,49:[1,25],50:[1,26],51:[1,27],52:[1,28],54:[1,30]},{4:[2,15],7:[2,15],20:[2,15]},{14:[1,132]},{22:[1,133]},{29:[1,134]},{15:[1,135],25:[1,36],26:[1,37],27:[1,38],28:[1,39]},{9:136,14:[1,16],19:[1,29],22:[1,35],30:17,31:18,32:19,33:20,34:21,35:[1,31],40:[1,22],46:[1,23],47:24,49:[1,25],50:[1,26],51:[1,27],52:[1,28],54:[1,30]},{16:137,19:[1,100]},{22:[1,138]},{16:139,19:[1,100]},{15:[1,140],25:[1,36],26:[1,37],27:[1,38],28:[1,39]},{7:[2,48],20:[2,48]},{16:141,19:[1,100]},{4:[2,16],7:[2,16],17:[2,16],20:[2,16]},{16:142,19:[1,100]},{7:[2,49],20:[2,49]},{4:[2,17],7:[2,17],17:[2,17],20:[2,17]}],defaultActions:{2:[2,1],32:[2,2]},parseError:function(str,hash){if(!hash.recoverable)throw new Error(str);this.trace(str)},parse:function(input){function lex(){var token;return token=self.lexer.lex()||EOF,"number"!=typeof token&&(token=self.symbols_[token]||token),token}var self=this,stack=[0],vstack=[null],lstack=[],table=this.table,yytext="",yylineno=0,yyleng=0,recovering=0,TERROR=2,EOF=1,args=lstack.slice.call(arguments,1);this.lexer.setInput(input),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,"undefined"==typeof this.lexer.yylloc&&(this.lexer.yylloc={});var yyloc=this.lexer.yylloc;lstack.push(yyloc);var ranges=this.lexer.options&&this.lexer.options.ranges;this.parseError="function"==typeof this.yy.parseError?this.yy.parseError:Object.getPrototypeOf(this).parseError;for(var symbol,preErrorSymbol,state,action,r,p,len,newState,expected,yyval={};;){if(state=stack[stack.length-1],this.defaultActions[state]?action=this.defaultActions[state]:((null===symbol||"undefined"==typeof symbol)&&(symbol=lex()),action=table[state]&&table[state][symbol]),"undefined"==typeof action||!action.length||!action[0]){var errStr="";expected=[];for(p in table[state])this.terminals_[p]&&p>TERROR&&expected.push("'"+this.terminals_[p]+"'");errStr=this.lexer.showPosition?"Parse error on line "+(yylineno+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+expected.join(", ")+", got '"+(this.terminals_[symbol]||symbol)+"'":"Parse error on line "+(yylineno+1)+": Unexpected "+(symbol==EOF?"end of input":"'"+(this.terminals_[symbol]||symbol)+"'"),this.parseError(errStr,{text:this.lexer.match,token:this.terminals_[symbol]||symbol,line:this.lexer.yylineno,loc:yyloc,expected:expected})}if(action[0]instanceof Array&&action.length>1)throw new Error("Parse Error: multiple actions possible at state: "+state+", token: "+symbol);switch(action[0]){case 1:stack.push(symbol),vstack.push(this.lexer.yytext),lstack.push(this.lexer.yylloc),stack.push(action[1]),symbol=null,preErrorSymbol?(symbol=preErrorSymbol,preErrorSymbol=null):(yyleng=this.lexer.yyleng,yytext=this.lexer.yytext,yylineno=this.lexer.yylineno,yyloc=this.lexer.yylloc,recovering>0&&recovering--);break;case 2:if(len=this.productions_[action[1]][1],yyval.$=vstack[vstack.length-len],yyval._$={first_line:lstack[lstack.length-(len||1)].first_line,last_line:lstack[lstack.length-1].last_line,first_column:lstack[lstack.length-(len||1)].first_column,last_column:lstack[lstack.length-1].last_column},ranges&&(yyval._$.range=[lstack[lstack.length-(len||1)].range[0],lstack[lstack.length-1].range[1]]),r=this.performAction.apply(yyval,[yytext,yyleng,yylineno,this.yy,action[1],vstack,lstack].concat(args)),"undefined"!=typeof r)return r;len&&(stack=stack.slice(0,-1*len*2),vstack=vstack.slice(0,-1*len),lstack=lstack.slice(0,-1*len)),stack.push(this.productions_[action[1]][0]),vstack.push(yyval.$),lstack.push(yyval._$),newState=table[stack[stack.length-2]][stack[stack.length-1]],stack.push(newState);break;case 3:return!0}}return!0}};return parser._performAction=parser.performAction,parser.performAction=function(yytext,yyleng,yylineno,yy,yystate,$$,_$){var ret=parser._performAction.call(this,yytext,yyleng,yylineno,yy,yystate,$$,_$);return this.$._type&&(this.$.lineNo=yylineno),ret},Parser.prototype=parser,parser.Parser=Parser,new Parser}();"undefined"!=typeof require&&"undefined"!=typeof exports&&(exports.parser=parser,exports.Parser=parser.Parser,exports.parse=function(){return parser.parse.apply(parser,arguments)},exports.main=function(args){args[1]||(console.log("Usage: "+args[0]+" FILE"),process.exit(1));var source=require("fs").readFileSync(require("path").normalize(args[1]),"utf8");return exports.parser.parse(source)},"undefined"!=typeof module&&require.main===module&&exports.main(process.argv.slice(1)))}).call(this,require("c:\\Users\\Mosho\\Documents\\GitHub\\DL-Shade2\\DL-Shade\\node_modules\\grunt-browserify\\node_modules\\browserify\\node_modules\\insert-module-globals\\node_modules\\process\\browser.js"))},{"c:\\Users\\Mosho\\Documents\\GitHub\\DL-Shade2\\DL-Shade\\node_modules\\grunt-browserify\\node_modules\\browserify\\node_modules\\insert-module-globals\\node_modules\\process\\browser.js":3,fs:1,path:4}],18:[function(require,module,exports){(function(process){var ScopeManager=function(){this.initialise.apply(this,arguments)};ScopeManager.prototype={initialise:function(){_.bindAll(this),this.global=new Scope("__GLOBAL__"),this.currentScope=this.global},createScope:function(name){var scope=this.currentScope.pushScope(name,this.currentScope);scope||(console.log("Scope conlict: Cannot define identifier %s in scope %s",name,this.currentScope.name),process.exit()),this.currentScope=scope},changeScope:function(name){var scope=this.currentScope.pushScope(name,this.currentScope);scope||(console.log("Scope conlict: Cannot define identifier %s in scope %s",name,this.currentScope.name),process.exit()),this.currentScope=scope},exitScope:function(){this.currentScope.parent&&(this.currentScope=this.currentScope.parent)},pushIdentifier:function(name,node){this.currentScope.pushIdentifier(name,node)},pushNamespace:function(ns,name){for(var v in ns)this.currentScope.pushIdentifier(name+"."+v,{expr:{_type:"Function"}})},hasIdentifier:function(name){return this.currentScope.hasIdentifier(name)},getIdentifier:function(name){return this.currentScope.getIdentifier(name)}};var Scope=function(){this.initialise.apply(this,arguments)};Scope.prototype={initialise:function(name,parent){_.bindAll(this),this.name=name,this.parent=parent,this.identifiers={},this.children={}},pushIdentifier:function(name,node){this.identifiers[name]=node},hasIdentifier:function(name){return name in this.identifiers},getIdentifier:function(name){return this.identifiers[name]},pushScope:function(name){return this.hasScope(name)?!1:(this.children[name]=new Scope(name,this),this.children[name])},hasScope:function(name){return name in this.children}},exports.ScopeManager=ScopeManager}).call(this,require("c:\\Users\\Mosho\\Documents\\GitHub\\DL-Shade2\\DL-Shade\\node_modules\\grunt-browserify\\node_modules\\browserify\\node_modules\\insert-module-globals\\node_modules\\process\\browser.js"))},{"c:\\Users\\Mosho\\Documents\\GitHub\\DL-Shade2\\DL-Shade\\node_modules\\grunt-browserify\\node_modules\\browserify\\node_modules\\insert-module-globals\\node_modules\\process\\browser.js":3}],19:[function(require,module){(function(){module.exports={observe:function(object,property,value,handler){var get,getter,set,setter,_ref;return _ref=handler||{},get=_ref.get,set=_ref.set,getter=function(){return"function"==typeof get?get():void 0},setter=function(newValue){return"function"==typeof set&&set(newValue),value=newValue},_.isFunction(Object.defineProperty)?Object.defineProperty(object,property,{get:getter,set:setter}):(object.__defineGetter__(property,getter),object.__defineSetter__(property,setter))
}}}).call(this)},{}],20:[function(require,module,exports){function tsort(edges){var nodes={},sorted=[],visited={},Node=function(id){this.id=id,this.afters=[]};return edges.forEach(function(v){var from=v[0],to=v[1];nodes[from]||(nodes[from]=new Node(from)),nodes[to]||(nodes[to]=new Node(to)),nodes[from].afters.push(to)}),Object.keys(nodes).forEach(function visit(idstr,ancestors){var node=nodes[idstr],id=node.id;visited[idstr]||(Array.isArray(ancestors)||(ancestors=[]),ancestors.push(id),visited[idstr]=!0,node.afters.forEach(function(afterID){if(ancestors.indexOf(afterID)>=0)throw new Error("closed chain : "+afterID+" is in "+id);visit(afterID.toString(),ancestors.map(function(v){return v}))}),sorted.unshift(id))}),sorted}var parser=require("./calculator").parser,CalcHandlers=require("./calc-handlers");_=_||{},_.observe=require("./tools").observe;var VariableRegistry=function(){this.initialise.apply(this,arguments),this.variables={}};VariableRegistry.prototype={initialise:function(){_.bindAll(this)},addToEntry:function(entry){var _entry=this.createEntry(entry);this.variables[entry.name]=_entry.concat(this.variables[entry.name]||{})},createEntry:function(entry){var _entry=new VariableEntry(entry),_this=this;return _.observe(_entry,"model",42,{set:function(value){_this.set(_entry.name,value)},get:function(){return _this.getValue(_entry.name)}}),_entry},set:function(name,value){this.variables[name]&&(this.variables[name].set(value),this.evaluate(name))},getValue:function(name){return this.variables[name]?this.variables[name].get():void 0},get:function(name){return this.variables[name]},unset:function(name){this.variables[name]&&this.variables[name].unset()},evaluate:function(changed){parser.yy=new CalcHandlers(this.variables);var val,i,entry,start=changed?this.sorted.indexOf(changed)+1:0;for(i=0;i<this.sorted.length-start;i++)entry=this.get(this.sorted[start+i]),entry&&(val=entry.expr?parser.parse(entry.expr):entry.expr,entry.evaluate(val));return this},sortDependencies:function(){this.edges=this.getEdges(),this.sorted=tsort(this.edges);var v;for(v in this.variables)this.variables.hasOwnProperty(v)&&-1===this.sorted.indexOf(v)&&this.sorted.unshift(v);return this},getEdges:function(){var entry,i,v,edges=[];for(v in this.variables)if(entry=this.variables[v],entry.hasOwnProperty("dependedOnBy"))for(i=0;i<entry.dependedOnBy.length;i++)edges.push([v,entry.dependedOnBy[i]]);return edges}};var VariableEntry=function(){var args=arguments,entry=args[0];this.initialise.apply(this,arguments),arguments.length?_.isObject(entry)?(this.name=entry.name||"",this.expr=entry.expr||"",this.value=0===entry.value?0:entry.value||null,this.setValue=0===entry.setValue?0:entry.setValue||null,this.dependsOn=entry.dependsOn||[],this.dependedOnBy=entry.dependedOnBy||[]):(this.name=args[0]||"",this.expr=args[1]||"",this.value=0===args[2]?0:args[2]||null,this.setValue=0===args[3]?0:args[3]||null,this.dependsOn=args[4]||[],this.dependedOnBy=args[5]||[]):(this.name="",this.expr="",this.value=null,this.setValue=null,this.dependsOn=[],this.dependedOnBy=[])};VariableEntry.prototype={initialise:function(){_.bindAll(this)},concat:function(entry){return entry&&(this.name=entry.name||this.name,this.expr=entry.expr||this.expr,this.value=0===entry.value?0:entry.value||this.value,this.setValue=0===entry.setValue?0:entry.setValue||this.setValue,this.dependsOn=_.union(this.dependsOn,entry.dependsOn),this.dependedOnBy=_.union(this.dependedOnBy,entry.dependedOnBy)),this},evaluate:function(value){return this.value=value,this},set:function(value){return this.setValue=value,this},get:function(){return _.isNull(this.setValue)||_.isUndefined(this.setValue)?this.value:this.setValue},unset:function(){return this.setValue=null,this}},exports.VariableEntry=VariableEntry,exports.VariableRegistry=VariableRegistry},{"./calc-handlers":8,"./calculator":9,"./tools":19}]},{},[12]),function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module){var handleCol=function(col){this[col.Name]=_.transform(_.omit(col,"Name"),function(str,val,opt){str.push(opt.charAt(0)+"="+val)},[])},getOptions=function(c){var opts={};return c.Col.length?_.each(c.Col,handleCol,opts):handleCol.call(opts,c.Col),opts},getHeaderAndItems=function(node){var items=node.Items.replace(/\s/g,"").split(/;+/);return{header:items[0],items:items.slice(1).join(",")}},makeOptionString=function(items,opts){return items.map(function(item){return(opts[item]||[]).join("&")}).join("|")},makeOptions=function(c,items){if(c&&c.Col){var options=getOptions(c);return makeOptionString(items.split("|"),options)}},createPropertyString=function(options){return _.map(options,function(option,key){return key+"="+option}).join(" ")};module.exports=function(node,wat,multiSelect){var parts=getHeaderAndItems(node),options=makeOptions(node.Cols,parts.items),propertyString=createPropertyString({"multi-select":!!multiSelect,header:parts.header,items:parts.items,options:options});this.openElement("drop-down","",node,"",propertyString),this.closeElement()},module.exports.test={handleCol:handleCol,getOptions:getOptions,getHeaderAndItems:getHeaderAndItems,makeOptionString:makeOptionString,makeOptions:makeOptions,createPropertyString:createPropertyString}},{}],2:[function(require,module){var that={},modeHandlers={Span:function(grid){return span=grid.Span.split(","),span=span.map(Math.floor),{span:span}},Rows:function(grid){return span=[grid.Rows,grid.Sub.Node.length/Number(grid.Rows)],flow="TToB",{span:span}},Cols:function(grid){return span=[grid.Sub.Node.length/grid.Cols,Number(grid.Cols)],{span:span}},ColWidth:function(grid,span){return widths=grid.ColWidth.match(/[^ ,]+/g),span[1]=Math.max(span[1],widths.length),{span:span,widths:widths}},RowHeight:function(grid,span){return heights=grid.RowHeight.match(/[^ ,]+/g),span[0]=Math.max(span[0],heights.length),{span:span,heights:heights}},Xy:function(grid,span){var nodes=_.filter(grid.Sub.Node,"Xy"),free_nodes=_.reject(grid.Sub.Node,"Xy"),gridMap=_.map(nodes,function(node,index){return[node.Xy.match(/[^ ,]+/g).reduce(function(prev,cur){return+prev*span[1]+ +cur})].concat(index)}).sort(function(a,b){return a[0]-b[0]});return grid.Sub.Node=function(){var i,arr=[],j=0;for(i=0;i<span[0]*span[1];i++)arr.push((gridMap[0]||[-1])[0]===i?nodes[gridMap.shift()[1]]:free_nodes[j++]||{UI:"Label"});return arr}(),{grid:grid}},CSpan:function(grid){for(var cspan,nodes=grid.Sub.Node,i=0;i<nodes.length;)cspan=+nodes[i].CSpan||1,[].splice.apply(nodes,[i,0].concat(new Array(cspan).join("0").split(""))),i+=cspan;return{grid:grid}}},makeCol=function(node){if(angular.isObject(node)){var colCount=this.colCount,widths=this.widths,lastWidth=widths[colCount++]||widths[widths.length-1],width=widths.length?"width:"+lastWidth+"px; ":"";that.openElement("td","",{},width,node.CSpan?'colspan="'+node.CSpan+'"':""),that.nodeHandlers.Node(_.omit(node,"CSpan")),that.closeElement()}},makeRow=function(nodes,heights,widths,rowCount){var lastHeight=heights[rowCount++]||heights[heights.length-1],height=heights.length?"height:"+lastHeight+"px; ":"",colCount=0;that.openElement("tr","",{},height),_.each(nodes,makeCol,{widths:widths,colCount:colCount}),that.closeElement()},makeGrid={TToB:function(grid,heights,widths,span){var i,filterFunction=function(elm,ind){return ind%span[1]===i},nodes=grid.Sub.Node;for(i=0;i<span[1];i++)makeRow(nodes.filter(filterFunction),heights,widths)},LToR:function(grid,heights,widths,span){var i,rowCount=0,nodes=grid.Sub.Node;for(i=0;i<nodes.length;i+=span[1])makeRow(nodes.slice(i,i+span[1]),heights,widths,rowCount)},single:function(grid,heights,widths){makeRow([grid.Sub.Node],heights,widths,0)}},handleMode=function(mode,data){return nodes=this.Sub.Node,this[mode]&&"Xy"!==mode&&"CSpan"!==mode||"Xy"===mode&&_.some(nodes,"Xy")||"CSpan"===mode&&_.some(nodes,"CSpan")?modeHandlers[mode](this,data.span):void 0},modes=["ColWidth","RowHeight","Span","Rows","Cols","CSpan","Xy"];module.exports=function(grid){if(that=this,_.isObject(grid)){var flow=grid.Sub.Node.length?grid.Flow||"LToR":"single";data={grid:grid,heights:"",widths:"",span:[]},_.each(modes,function(mode){_.extend(data,handleMode.call(grid,mode,data))}),data.span[1]>0&&(that.openElement("table","",grid,""),makeGrid[flow](data.grid,data.heights,data.widths,data.span),that.closeElement())}},module.exports.test={modeHandlers:modeHandlers,makeCol:makeCol,makeRow:makeRow,makeGrid:makeGrid,handleMode:handleMode}},{}],3:[function(require){angular.module("ShadeServices",[]).service("ShadeHandlers",function(ShadeElements,ShadeStyles){this.openElement=ShadeElements.openElement,this.closeElement=ShadeElements.closeElement,this.getCurrent=ShadeElements.getCurrent,this.addStyles=ShadeStyles.addStyles,this.handleStyles=ShadeStyles.handleStyles;var that=this,handleSub=function(node){_.each(((angular.isArray(node.Sub)?node.Sub:{Node:node.Sub})||{Node:{}}).Node,that.handleNodes)};return this.CbHandlers={SETDLVARIABLE:function(cb){return cb.Event+",setDL,"+cb.Stat},SHOWPOPUP:function(cb){return cb.Event+",popup,"+cb.Stat},MESSAGE:function(){}},this.UIHandlers={Button:function(node,cb){that.openElement("shd-button","btn btn-default",node,"",cb,""),that.closeElement()},CheckBox:function(node){var attrs=node.Value?"":'type="checkbox" label="'+node.Text+'"';that.openElement("div","inputs",node,"",attrs),that.closeElement()},DatePicker:function(node){that.openElement("shd-date-picker","",node,""),that.closeElement()},DropDown:require("./DropDown"),Grid:require("./Grid"),Image:function(node){that.openElement("shd-image","",node,"","",""),that.closeElement()},Item:function(node){that.openElement("li"),that.openElement("a","",{},"",'href="#"',node.Text),node.Sub&&(that.openElement("ul"),handleSub(node),that.closeElement()),that.closeElement(),that.closeElement()},Label:function(node){that.openElement("div","",node),that.closeElement()},ListBox:function(node){that.openElement("list-box","",node),handleSub(node),that.closeElement()},ListItem:function(node){that.openElement("option","",node),that.closeElement()},Menu:function(node){that.openElement("ul","menu"),handleSub(node),that.closeElement()},MultiSelComboBox:_.partialRight(require("./DropDown"),!0),NumEdit:function(node){that.openElement("div","inputs",node,"",'type="text"'),that.closeElement()},NumericUpDown:function(node){that.openElement("num-up-down","",node),that.closeElement()},Popup:function(node){that.openElement("popup","",node,"display:none;"),handleSub(node),that.closeElement()},RadioButton:function(node){var attrs=node.Value?"":'type="radio" value="'+node.Text+'" label="'+node.Text+'"';that.openElement("div","inputs",node,"",attrs),that.closeElement()},TabSet:function(node){that.openElement("tabset","",node),handleSub(node),that.closeElement()},Tab:function(node){that.openElement("tab","",node,"",'heading="'+node.Text+'"',""),handleSub(node),that.closeElement()},TestDL:function(node){that.openElement("test-dl","",node),that.closeElement()},TextBox:function(node){var attrs='type="text" placeholder="'+node.Text+'"';that.openElement("div","inputs",node,"",attrs,""),that.closeElement()},TimePicker:function(node){that.openElement("time-picker","",node,"display:inline-block;"),that.closeElement()},Unknown:function(node){console.log("can't find control - "+node.UI)}},this.nodeHandlers={Styles:that.addStyles,Node:function(node){var handleCb=function(result,Cb){return result+=(result?";":"")+that.CbHandlers[Cb.Fn](Cb)},controlBlock=node.Cb?'control-block="'+_.reduce(node.Cb.length?node.Cb:[node.Cb],handleCb,"")+'" ':"";(that.UIHandlers[node.UI]||that.UIHandlers.Unknown).call(that,node,controlBlock)},Unknown:function(node,index){console.log("can't recognize tag <"+index+">.")}},this.handleNodes=function(node,index){if(angular.isArray(node))_.each(node,that.handleNodes.bind({index:index}));else{var handlers=that.nodeHandlers;(handlers[index]||handlers[this.index]||handlers.Unknown)(node,index)}},this}).service("ShadeParser",function(ShadeHandlers,ShadeStyles,ShadeElements){return this.parse=function(shd){return shd?(ShadeStyles.init(),ShadeElements.init(),_.each(shd.Shade,ShadeHandlers.handleNodes),{shade:shd.Shade,styles:ShadeStyles.getStyles(),elements:ShadeElements.getElements(),elementsById:ShadeElements.getElementsById()}):void 0},this}).service("ShadeStaticHandlers",function(){return this.attrNameHandlers={vDL:"",vText:"",Name:"id",vActiveTabIndex:"",CSpan:"colspan",DefaultValue:"dvalue",Maximum:"max",Minimum:"min",FormatString:"format",Source:"src",Text:"text",vSub:""},this.attrValueHandlers={},this.styleNameHandlers={Width:"",Height:"",Fg:"color",Bg:"background-color"},this.styleValueHandlers={Width:function(width){return width+"px"},Height:function(height){return height+"px"}},this}).service("ShadeStyles",function(ShadeStaticHandlers){var styleNames=ShadeStaticHandlers.styleNameHandlers,styleValues=ShadeStaticHandlers.styleValueHandlers,gstyles="",translateStyle=function(style,value){var styleTranslation,type,ret="";if(value&&styleNames.hasOwnProperty(style)){ret+=(styleNames[style]||style)+": ",type=typeof(styleTranslation=styleValues[value]||styleValues[style]);var typeHandlers={undefined:function(value){return value.toLowerCase()},"function":function(value){return styleTranslation(value)},other:function(){return styleTranslation}};ret+=(typeHandlers[type]||typeHandlers.other)(value)+" !important;"}return ret};return this.addStyles=function(className,styles){if(_.isString(className)&&_.isString(styles))gstyles+="."+className+" { "+styles+"}\n";else{var parsedStyles=className.replace(/\s/g,"").replace(/(\w+):(\w+)/g,function(match,p1,p2){return translateStyle(p1,p2)});gstyles+=parsedStyles+"\n"}},this.handleStyles=function(styles,value,style){return styles+translateStyle(style,value)},this.getStyles=function(){return gstyles},this.init=function(){gstyles=""},this}).service("ShadeElements",function(ShadeStyles){var classCount=0,elmId=0,elements=[],elementsById=[],currentElement={nodes:elements};return this.openElement=function(elmName,className,node,customStyles,customAttr,content,close){_.isEmpty(node)||(node.id=elmId,elementsById[elmId++]=node);var nativeStyles=_.reduce(node,ShadeStyles.handleStyles,""),nativeClass=nativeStyles||customStyles?"class"+ ++classCount:"",node=node||{};cur=currentElement.nodes.push({elmName:elmName,nativeClass:nativeClass+(node.Style?" "+node.Style:""),className:className,node:node,customStyles:customStyles,customAttr:customAttr,content:angular.isDefined(content)?content:node.Text,nodes:[],parent:currentElement,id:node.id,close:_.isUndefined(close)}),(customStyles||nativeStyles)&&ShadeStyles.addStyles(nativeClass,(customStyles||"")+(nativeStyles||"")),currentElement=currentElement.nodes[cur-1]},this.closeElement=function(){currentElement=currentElement.parent},this.getCurrent=function(){return currentElement},this.getElements=function(){return elements},this.getElementsById=function(){return elementsById},this.init=function(){classCount=0,elmId=0,elements=[],currentElement={nodes:elements},elementsById=[]},this})},{"./DropDown":1,"./Grid":2}]},{},[3]),function(){angular.module("ShadeApp",["ShadeServices","ngGrid","mgcrea.ngStrap.popover","ui.bootstrap"])}.call(this),function(){angular.module("ShadeApp").directive("format",function(format){return{restrict:"A",require:"?ngModel",link:{pre:function(scope,elm,attr,ngModel){var formatStr;return formatStr=attr.format,angular.isDefined(ngModel)?(ngModel.$formatters.push(function(value){return angular.isNumber(value)?value=format(value,formatStr):void 0}),ngModel.$parsers.unshift(function(value){return isNaN(value)&&(value=ngModel.$modelValue),+value}),elm.on("blur",function(){return elm.val(isNaN(elm.val())?format(+ngModel.$modelValue,formatStr):format(+elm.val(),formatStr))})):void 0}}}}).directive("vActiveTabIndex",function(){return{restrict:"A",link:function(scope,elm,attr){return scope.vactive=attr.vActiveTabIndex,scope.$watch("vars[vactive].model",function(vactive){return vactive=Number(vactive),angular.isDefined(scope.tabs[vactive])?_.each(scope.tabs,function(tab,ind){return tab.active=!1,ind===vactive?tab.active=!0:void 0}):void 0}),scope.$watch("active",function(active){return scope.vars[scope.vactive].model=active})}}}).directive("vSub",function($compile,shadeData,shadeTemplate,x2js){return{restrict:"A",link:function(scope,elm,attr){return scope.vSub=attr.vSub,scope.$watch("vSub",function(){var body,content,shadeNode;return shadeNode=shadeData.getElementById(attr.shdId),shadeNode.Sub.Node.push(x2js.xml2json(scope.vars[scope.vSub].model).Node),content=shadeTemplate.toHTML({Shade:{Node:shadeNode}}),body=angular.element(content.body),elm.html(body.html()),$compile(elm.contents())(scope)})}}})}.call(this),function(){angular.module("ShadeApp").directive("shdButton",function($compile,$timeout){return{restrict:"E",replace:!0,scope:!0,transclude:!0,template:function(elm,attr){var cbs,events,handlers,toAppend;return toAppend="",attr.controlBlock&&(cbs=function(){var cb_arr,obj;return obj={},cb_arr=attr.controlBlock.split(";"),cb_arr=_.map(cb_arr,function(str){return str.split(/\s?,\s?/)}),_.each(cb_arr,function(arr){return obj[arr[0]]=obj[arr[0]]||[],obj[arr[0]].push(arr.slice(1))}),obj}(),events={Click:"ng-click=","default":"ng-click="},handlers={setDL:function(name,val){return"vars[&quot;"+name+"&quot;].model="+val+";"},popup:function(popup,location){return"popup('"+popup+"','"+location+"')"}},_.each(cbs,function(cb,name){return toAppend+=(events[name]||events["default"])+'"'+_.map(cb,function(el){return handlers[el[0]](el[1],el[2])}).join("")+'" '})),"<button "+toAppend+">{{vars[vText].model||text}}</button>"},link:function(scope,elm,attr){return scope.vText=attr.vText,scope.text=attr.text,scope.popup=function(id,elm){var clone,popup;popup=angular.element("#"+id),popup.attr("container")!=="#"+elm&&(popup.triggerHandler("leave"),clone=popup.clone(),popup.after(clone).remove(),clone.children().removeAttr("ng-transclude"),clone.attr({container:"#"+elm,"bs-popover":"",trigger:"manual",template:angular.element("<div />").append(angular.element("<div />").append(angular.element('<div class="popupt"/>').append(clone.children()))).html()}),popup=$compile(clone)(scope)),$timeout(function(){return popup.triggerHandler("popup")},50)}}}})}.call(this),function(){angular.module("ShadeApp").directive("dropDown",function($filter,$timeout,$rootScope,ngGridFlexibleHeightPlugin){return{restrict:"E",replace:!0,scope:!0,template:'<table class="dropdown" ng-click="dropdown($event,ghide)"><tr class="selected"><td class="selectedItems">{{selected|selectedArray}}</td><td class="glyphicon glyphicon-chevron-down"></td></tr> <tr class="gridStyle" ng-grid="gridOptions" ng-class="{hide:ghide}" ng-click="select($event)" ng-animate></tr></table>',link:{pre:function(scope,elm,attr){var header,items;return header=attr.header.split("|"),items=attr.items.split(",").map(function(elm){return elm.split("|")}),scope.myData=items.map(function(elm){return elm.reduce(function(obj,el,ind){return obj[header[ind]]=el,obj},{})}),scope.selected=["Click me"],scope.gridOptions={data:"myData",selectedItems:scope.selected,multiSelect:"true"===attr.multiSelect,plugins:[new ngGridFlexibleHeightPlugin({maxHeight:300})],enableSorting:!1,rowHeight:27},scope.ghide=!0,scope.dropdown=function($event,state){return state&&$rootScope.$broadcast("fade"),_.kill_event($event),scope.ghide=!state},scope.select=function($event){return _.kill_event($event)},scope.$on("bg_click",function(){return scope.dropdown()}),scope.$on("fade",function(){return scope.dropdown()}),scope.$watchCollection("selected",function(){return"false"===attr.multiSelect?scope.ghide=!0:void 0})}}}})}.call(this),function(){angular.module("ShadeApp").directive("numUpDown",function($timeout){return{restrict:"E",scope:!1,template:function(elm,attr){var getAttrs;return getAttrs=function(){var args;return args=arguments,_.reduce(args,function(str,val){return str+val+'="'+attr[val]+'" '},"")},'<div class="input-group"><input style="width:90%" class="form-control" type="text" ng-model="vars[vText].model" dvalue="'+getAttrs("dvalue","min","max","format")+'"/><div class="btn-group-vertical"><button class="btn btn-default" ng-mousedown="increase()" ng-mouseup="stop()" ng-mouseout="stop()"><span class="glyphicon glyphicon-chevron-up" /></button><button class="btn btn-default" ng-mousedown="decrease()" ng-mouseup="stop()" ng-mouseout="stop()"><span class="glyphicon glyphicon-chevron-down" /></button></div></div>'},link:function(scope,elm,attr){var change,cto,formatStr,maxVal,minVal,mtimeout,step,test,timeout,updateModel;return scope.vText=attr.vText,test=null,step=1,minVal=+attr.min,maxVal=+attr.max,formatStr=attr.format,timeout=300,mtimeout=30,cto=null,updateModel=function(value){return value=+value,scope.vars&&_.isFinite(value)?scope.vars[scope.vText].model=value>maxVal?maxVal:minVal>value?minVal:value:void 0},$timeout(function(){return updateModel(+attr.dvalue)}),change=function(d){return timeout>mtimeout&&(timeout-=30),$timeout(function(){return updateModel(scope.vars[scope.vText].model+d)}),cto=setTimeout(change,timeout,d)},scope.increase=_.partial(change,1),scope.decrease=_.partial(change,-1),scope.stop=function(){return clearTimeout(cto),timeout=300}}}})}.call(this),function(){angular.module("ShadeApp").directive("renderPanel",function($compile,$rootScope,shadeTemplate,shadeData){return{restrict:"E",scope:{vars:"=",graph:"=",styles:"="},controller:function($element,$scope){this.render=function(){return shadeData.set(shadeTemplate.toHTML($scope.styles))?($element.html("<style>"+shadeData.getStyles()+"</style>"+shadeData.getBody()),$compile($element.contents())($scope)):void 0},$rootScope.$on("Run",this.render)}}}).directive("prettyPrintPanel",function($filter,shadeTemplate){return{restrict:"A",replace:!0,template:'<div class="pp-panel"></div>',link:function(scope,elm,attrs){return scope.$watch(attrs.prettyPrintPanel,function(shade){var code,pre,raw_html;return raw_html=$filter("indentHTML")((shadeTemplate.toHTML(shade)||{body:""}).body),pre=angular.element('<pre class="prettyprint lang-html" style="font-size:0.75em"></pre>'),code=angular.element("<code></code>"),code.html($filter("escapeHTML")(raw_html)),pre.append(code),elm.html(pre),prettyPrint()})},controller:function($scope,$http){var themes;return $scope.themes=themes={list:["google-code-light","solarized-dark","solarized-light","sons-of-obsidian-dark","tomorrow-night-blue","tomorrow-night-dark","tomorrow-night-light","tomorrow-night-eighties"],selected:"google-code-light"},$scope.$watch("themes.selected",function(theme_name){var url;return url="styles/gprettify/"+theme_name+".css",$http.get(url).then(function(response){return themes.css=response.data})})}}})}.call(this),function(){angular.module("ShadeApp").directive("shdImage",function($http){return{restrict:"E",replace:!0,scope:!0,require:"?ngModel",template:'<img ng-model="vars[vText].model" />',link:function(scope,elm,attr,ngModel){return scope.src=attr.src,scope.vText=attr.vText,angular.isDefined(ngModel)?ngModel.$render=function(){return $http.head(ngModel.$modelValue).success(function(){return elm.attr("src",ngModel.$modelValue)}).error(function(){return elm.attr("src",scope.src)})}:void 0}}})}.call(this),function(){angular.module("ShadeApp").directive("listBox",function(vTextProvider){return new vTextProvider("<select multiple ng-transclude />")}).directive("inputs",function(vTextProvider){return new vTextProvider("<input />")}).directive("shdDatePicker",function(vTextProvider){return new vTextProvider('<input type="text" datepicker-popup close-on-date-selection="false" />')}).directive("timePicker",function(vTextProvider){return new vTextProvider("<div><timepicker /></div>")})}.call(this),function(){angular.module("ShadeApp").factory("ngGridFlexibleHeightPlugin",function(){var ngGridFlexibleHeightPlugin;return ngGridFlexibleHeightPlugin=function(opts){var self;self=this,self.grid=null,self.scope=null,self.init=function(scope,grid,services){var innerRecalcForData,recalcHeightForData;self.domUtilityService=services.DomUtilityService,self.grid=grid,self.scope=scope,recalcHeightForData=function(){setTimeout(innerRecalcForData,1)},innerRecalcForData=function(){var extraHeight,footerPanelSel,gridId,naturalHeight,newViewportHeight;gridId=self.grid.gridId,footerPanelSel="."+gridId+" .ngFooterPanel",extraHeight=self.grid.$topPanel.height()+$(footerPanelSel).height(),naturalHeight=self.grid.$canvas.height()+1,null!=opts&&(null!=opts.minHeight&&naturalHeight+extraHeight<opts.minHeight&&(naturalHeight=opts.minHeight-extraHeight-2),null!=opts.maxHeight&&naturalHeight+extraHeight>opts.maxHeight&&(naturalHeight=opts.maxHeight-extraHeight-2)),newViewportHeight=naturalHeight+2,self.scope.baseViewportHeight&&self.scope.baseViewportHeight===newViewportHeight||(self.grid.$viewport.css("height",newViewportHeight+"px"),self.grid.$root.css("height",newViewportHeight+extraHeight+"px"),self.scope.baseViewportHeight=newViewportHeight,self.domUtilityService.RebuildGrid(self.scope,self.grid))},self.scope.catHashKeys=function(){var hash,idx;hash="",idx=void 0;for(idx in self.scope.renderedRows)hash+=self.scope.renderedRows[idx].$$hashKey;return hash},self.scope.$watch("catHashKeys()",innerRecalcForData),self.scope.$watch(self.grid.config.data,recalcHeightForData)}}})}.call(this),function(){angular.module("ShadeApp").factory("vTextProvider",function(){return function(template){this.restrict="ACE",this.transclude=!!template.match("ng-transclude"),this.replace=!0,this.scope=!0,this.template=template.replace(/\/?>/,function(match){return' ng-model="vars[vText].model" '+match}),this.link=function(scope,elm,attr){return scope.vText=attr.vText,attr.label?elm.after("<span>"+attr.label+"</span>"):void 0}}})}.call(this),function(){angular.module("ShadeApp").filter("selectedArray",function(){return function(arr){return _.isString(arr[0])&&1===arr.length?arr[0]:_.reduce(arr,function(str,item,ind){return _.isPlainObject(item)?str+_.values(item)+(ind!==arr.length-1?";":""):str},"")}})}.call(this),function(){angular.module("ShadeApp").service("format",function(){return function(input,str){var i,length,matches,output,replacer;return angular.isNumber(input)?(input=input.toString(),replacer=function(match){return"."===input[i]&&i++,input[i++]||("#"===match?"":"0")},length=parseInt(input,10).toString().length,matches=str.match(/[0#](?=.*\.)/g).length,i=length-matches,output=str.replace(/[\s,]/g,"").replace(/[0#]/g,replacer)):void 0}})}.call(this),function(){angular.module("ShadeApp").service("shadeData",function(){var data;return data={},this.set=function(_data){return data=_data},this.get=function(){return data},this.getElementById=function(id){return data.elementsById[id]},this.getStyles=function(){return data.styles},this.getBody=function(){return data.body},this})}.call(this),function(){angular.module("ShadeApp").service("ShadeIdentifiers",function(ShadeStaticHandlers,ShadeHandlers){var sh,sw;return sh=ShadeStaticHandlers,sw=ShadeHandlers,function(key,an,av,sn,sv,c,cb,mn){return{attrNames:{type:"Attribute Name",keys:key(an||{})},attrValues:{type:"Attribute Value",keys:key(av||{})},styleNames:{type:"Style Name",keys:key(sn||{})},styleValues:{type:"Style Value",keys:key(sv||{})},controls:{type:"Control",keys:key(c||{})},controlBlocks:{type:"Control Block",keys:key(cb||{})},mainNodes:{type:"",keys:key(mn||{})}}}(Object.keys,sh.attrNameHandlers,sh.attrValueHandlers,sh.styleNameHandlers,sh.styleValueHandlers,sw.UIHandlers,sw.CbHandlers,sw.nodeHandlers)}).service("ShadeAttrDictionary",function(ShadeStaticHandlers){return{attrNameHandlers:ShadeStaticHandlers.attrNameHandlers,attrValueHandlers:ShadeStaticHandlers.attrValueHandlers}})}.call(this),function(){angular.module("ShadeApp").service("shadeTemplate",function($http,x2js,ShadeParser,ShadeAttrDictionary){var template;return template=function(){},$http.get("/scripts/Shade/ng_template_shd.ejs").success(function(data){return _.templateSettings.variable="shd",template=_.template(data)}).error(function(){return console.log("Could not retrieve shade template")}),this.toHTML=function(shade){var parsed;return angular.isObject(shade)||(shade=x2js.xml2json(shade)),parsed=ShadeParser.parse(shade)||{},_.extend(parsed,ShadeAttrDictionary),{body:template(parsed),styles:parsed.styles,elementsById:parsed.elementsById}},this})}.call(this),function(){"use strict";angular.module("DLApp",["ShadeApp"]).config(["$httpProvider",function($httpProvider){return $httpProvider.defaults.useXDomain=!0,delete $httpProvider.defaults.headers.common["X-Requested-With"]}]),_.kill_event=function(e){return _.isObject(e)?(e.cancelBubble=!0,e.stopPropagation(),e.preventDefault()):void 0},_.corsproxy=function(css_url){var m;return m=css_url.match(/https?:\/\/(.+)/),m?"http://www.corsproxy.com/"+m[1]:!1},_.position=function(elm){var p;for(p={x:elm.offsetLeft||0,y:elm.offsetTop||0};elm=elm.offsetParent;)p.x+=elm.offsetLeft,p.y+=elm.offsetTop;return p},String.prototype.toDash=function(){return this.replace(/([A-Z])/g,function($1){return"-"+$1.toLowerCase()})},_.toDash=function(str){return str.replace(/([A-Z])/g,function($1){return"-"+$1.toLowerCase()})},_.mapKeys=function(object,callback,thisArg){var result;return result={},callback=_.createCallback(callback,thisArg,3),_.forOwn(object,function(value,key,object){result[callback(value,key,object)]=value}),result}}.call(this);var default_lc;default_lc="/* Welcome to Dependency Language in JavaScript!\n Features:\n -Supported Formats:\n Numbers, Strings, arrays\n -Namespaces (format: '$ns') -Built-in Functions:\n f.abs, f.avg\n -Themes for the editor\n -Graph or table presentation of the graph\n -Click 'Run' above or alt+R \n -Alt + [1-5] toggles the panels*/\n \n x=1;\n y=2;\n z=f.avg(x,y,6);",angular.module("DLApp").controller("DLCtrl",function($scope,$rootScope,$http,$filter,$element,$document,$timeout,Graph){var DLpath;return $scope.DLcode={code:default_lc},DLpath="DLcode/test.txt",$http.get(DLpath).then(function(response){return $scope.DLcode={code:response.data}}),$document.keyup(function(e){var col;return e.altKey&&(82===e.keyCode&&$scope.DLrun(e),col=$scope.cols[e.keyCode-49])?$scope.$apply(col.show=!col.show):void 0}),$scope.styles={active:"control",sheets:{basics:{source:"XML/shade.xml","native":!0},control:{source:"XML/control.xml","native":!0},menu:{source:"XML/menu.xml","native":!0}},external:"",editor:""},$scope.copy_style=function(e,style_name){var copy,i,name;for(_.kill_event(e),copy=_.clone($scope.styles.sheets[style_name]),style_name=style_name.match(/(.*?)(:? copy(:? \d+)?)?$/)[1],name=""+style_name+" copy",i=0;name in $scope.styles.sheets;)name=""+style_name+" copy "+ ++i;return copy["native"]=!1,$scope.styles.sheets[name]=copy,$scope.styles.active=name},$scope.delete_style=function(e,style_name){return _.kill_event(e),delete $scope.styles.sheets[style_name],$scope.styles.active===style_name?$scope.styles.active=Object.keys($scope.styles.sheets)[0]:void 0},$scope.DLrun=function(e){return e&&_.kill_event(e),Graph.getGraph($scope.DLcode.code,$scope.styles,function(graph){return $scope.graph=graph.evaluate(),$rootScope.$broadcast("Run")})},$document.ready(function(){return $timeout($scope.DLrun,100)}),$scope.$watch("styles.active",function(){var styles;return $scope.styles.active in $scope.styles.sheets?(styles=$scope.styles.sheets[$scope.styles.active],styles.css?$scope.styles.editor=$filter("prettifyCSS")($filter("deSassify")(styles.css)):$http.get(styles.source).then(function(response){return styles.css=response.data,$scope.styles.editor=$filter("prettifyCSS")($filter("deSassify")(styles.css))})):void 0}),$scope.$watch("styles.editor",function(){return $scope.styles.sheets[$scope.styles.active]?$scope.styles.sheets[$scope.styles.active].css=$scope.styles.editor:void 0
}),$scope.$watch("styles.external",function(){return $scope.styles.external&&/^(https?:\/\/)?(\w+\.)+[\w\/]+/.test($scope.styles.external)?$http.get(_.corsproxy($scope.styles.external)).then(function(response){var file_name,i,name;for(i=0,file_name=$scope.styles.external.match(/.+?\/(\w+)\.css/),name=file_name&&file_name[1]||"external";name in $scope.styles.sheets;)name="external "+ ++i;return $scope.styles.sheets[name]={source:$scope.styles.external,css:response.data,external:!0,edited:!1},$scope.styles.active=name,$scope.styles.external=""}):void 0})}).directive("menu",function($compile,$rootScope){return{scope:{col:"=",themes:"=",setTheme:"&"},restrict:"C",controller:function($scope){return $scope.menuitems||($scope.menuitems={show:!1}),$scope.$on("bg_click",function(){return $scope.$apply(function(){return $scope.menuitems.show=!1})})},link:function(scope,elm){var menu_items;return elm.children(".menu-title").bind("click",function(e){var show;return _.kill_event(e),show=!scope.menuitems.show,$rootScope.$broadcast("bg_click"),scope.$apply(function(){return scope.menuitems.show=show})}),menu_items=elm.children(".menu-items"),menu_items.attr("ng-class","{in:menuitems.show}"),menu_items.bind("click",_.kill_event),$compile(menu_items)(scope)}}}),function(){angular.module("DLApp").directive("aceEditor",function(){return{restrict:"A",require:"?ngModel",scope:!1,link:function(scope,elm,attrs,ngModel){var acee,session;return scope.acee=acee=window.ace.edit(elm[0]),scope.session=session=acee.getSession(),scope.mode=attrs.mode,scope.makeCompletions=function(prefix,collection,meta){return collection.filter(function(elm){return elm.substring(0,prefix.length).toUpperCase()===prefix.toUpperCase()}).map(function(elm){return{name:elm,value:elm,meta:meta}})},acee.setTheme("ace/theme/solarized_light"),acee.getSession().setMode("ace/mode/"+scope.mode),acee.setOptions({showGutter:!0,enableCustomAutocompletion:!0}),acee.setReadOnly(!1),acee.setHighlightActiveLine(!1),acee.setShowPrintMargin(!1),acee.commands.on("afterExec",function(e){"insertstring"===e.command.name&&/^[\w.]$/.test(e.args)&&acee.execCommand("startCustomAutocomplete")}),scope.themes=["merbivore","merbivore_soft","mono_industrial","monokai","pastel_on_dark","solarized_dark","solarized_light","terminal","textmate","tomorrow","tomorrow_night","tomorrow_night_blue","tomorrow_night_eighties","twilight","vibrant_ink","xcode"],scope.setTheme=function(name){return scope.acee.setTheme("ace/theme/"+name)},angular.isDefined(ngModel)&&(ngModel.$formatters.push(function(value){if(angular.isUndefined(value)||null===value)return"";if(angular.isObject(value)||angular.isArray(value))throw new Error("ace-editor cannot use an object or an array as a model");return value}),ngModel.$render=function(){return session.setValue(ngModel.$viewValue)}),session.on("change",function(){var newValue;return newValue=session.getValue(),newValue!==scope.$eval(attrs.value)&&!scope.$$phase&&angular.isDefined(ngModel)?scope.$apply(function(){return ngModel.$setViewValue(newValue)}):void 0})},controller:function($scope,$rootScope){return $rootScope.$on("panel_resized",function(){return $scope.acee.resize()})}}}).directive("dlEditor",function(Graph){return{restrict:"A",scope:!1,link:function(scope,elm,attrs){var DLcompleter;return scope.langTools=window.ace.require("ace/ext/language_tools"),DLcompleter={getCompletions:function(editor,session,pos,prefix,callback){var functions,identifiers,nameList;return session.$modeId!=="ace/mode/"+attrs.mode?callback(null,[]):(identifiers=scope.makeCompletions(prefix,Object.keys(scope.graph.variables.variables),"variable"),functions=scope.makeCompletions(prefix,Graph.getFunctions(),"function"),nameList=identifiers.concat(functions),callback(null,nameList))}},scope.langTools.addCompleter(DLcompleter)}}}).directive("shadeEditor",function(Graph,ShadeIdentifiers){return{restrict:"A",scope:!1,link:function(scope,elm,attrs){var DLcompleter;return scope.langTools=window.ace.require("ace/ext/language_tools"),DLcompleter={getCompletions:function(editor,session,pos,prefix,callback){var nameList;return session.$modeId!=="ace/mode/"+attrs.mode?callback(null,[]):(nameList=[],_.each(ShadeIdentifiers,function(dict){return nameList=nameList.concat(scope.makeCompletions(prefix,dict.keys,dict.type))}),callback(null,nameList))}},scope.langTools.addCompleter(DLcompleter)}}})}.call(this),function(){angular.module("DLApp").directive("renderGraph",function(){return{restrict:"E",require:"?ngModel",scope:!1,controller:function($scope,$rootScope,$element,$compile,graphService){return $scope.gshow=!1,$scope.themes=["Graph","Table"],$scope.elems={},$scope.elems.Table=$compile('<div ng-hide="gshow"></div>')($scope),$scope.elems.Graph=$compile('<div ng-show="gshow"></div>')($scope),_.each($scope.elems,function(value){return $element.append(value)}),$rootScope.$on("Run",function(){return _.each($scope.themes,function(value){return graphService.deleteGraph(value),graphService.drawGraph[value]($scope.graph,$scope.elems[value][0])})}),$scope.setTheme=function(name){var _ref,_ref1;return graphService.deleteGraph(null!=(_ref="Graph"===name)?_ref:{Table:"Graph"}),graphService.drawGraph[name]($scope.graph,$scope.elems[name][0]),$scope.gshow=null!=(_ref1="Graph"===name)?_ref1:{"true":!1}}}}})}.call(this),function(){angular.module("DLApp").directive("splitRow",function(){return{restrict:"E",transclude:!0,scope:{styles:"=",graph:"=",cols:"=",col:"=",DLcode:"="},replace:!0,template:'<div class="split-row" ng-transclude></div>',controller:function($scope,$element,$compile,$rootScope,$window){var body,cols,dragged;$scope.row=$element[0],cols=$scope.cols=[],$scope.col=function(name){var c;return function(){var _i,_len,_results;for(_results=[],_i=0,_len=cols.length;_len>_i;_i++)c=cols[_i],c.name===name&&_results.push(c);return _results}()[0]},body=document.getElementsByTagName("body")[0],body.addEventListener("click",function(){return $rootScope.$broadcast("bg_click")}),$(document).keyup(function(e){return 27===e.keyCode?$rootScope.$broadcast("bg_click"):void 0}),this.equalCols=function(ncols){var c,new_ratio,_i,_len,_results;for(ncols||(ncols=function(){var _i,_len,_results;for(_results=[],_i=0,_len=cols.length;_len>_i;_i++)c=cols[_i],c.show&&_results.push(c);return _results}().length),new_ratio=1/ncols,_results=[],_i=0,_len=cols.length;_len>_i;_i++)c=cols[_i],_results.push(c.show?c.ratio=new_ratio:c.ratio=0);return _results},this.findLastCol=function(){var c,last_shown,_i,_len;if(cols.length){for(last_shown=null,_i=0,_len=cols.length;_len>_i;_i++)c=cols[_i],c.last_shown=!1,c.show&&(last_shown=c);return last_shown?last_shown.last_shown=!0:void 0}},this.addCol=function(col){return $scope.$apply(function(_this){return function(){return col.index=cols.length,cols.push(col),_this.equalCols(),col.div.append($compile('<drag-area ng-show="!last_shown"></drag-area>')(col))}}(this))},$window.r=$scope.row,dragged=function(_this){return function(x){return $scope.$apply(function(){var after,before,c,cumRatio,i;for(before=$scope.dragging,after=cols[i=before.index+1];!after.show;)after=cols[++i];return cumRatio=function(){var _i,_len,_results;for(_results=[],_i=0,_len=cols.length;_len>_i;_i++)c=cols[_i],c.index<before.index&&_results.push(c.ratio);return _results}().reduce(function(t,s){return t+s},0),before.ratio=(x-$scope.row.offsetLeft)/_this.row_width-cumRatio,before.ratio<.1&&(before.ratio=.1),after.ratio=1-function(){var _results;_results=[];for(i in cols)parseInt(i)!==after.index&&_results.push(cols[i].ratio);return _results}().reduce(function(t,s){return t+s},0),after.ratio<.1&&(after.ratio=.1,before.ratio=1-function(){var _results;_results=[];for(i in cols)parseInt(i)!==before.index&&_results.push(cols[i].ratio);return _results}().reduce(function(t,s){return t+s},0)),before.div[0].onresize&&before.div[0].onresize(),after.div[0].onresize&&after.div[0].onresize(),$rootScope.$broadcast("panel_resized")})}}(this),($scope.row.onresize=function(_this){return function(){return _this.row_width=$scope.row.offsetWidth}}(this))(),this.start_drag=function(col,e){return _.kill_event(e),$scope.dragging=col},document.onmousemove=function(e){return e.preventDefault(),$scope.dragging&&dragged(e.clientX),e.caughtBy?void 0:$rootScope.$broadcast("mousemoved")},document.onmouseup=function(){return $scope.dragging=null}}}}).directive("resizablePanel",function($rootScope,$timeout){return{require:"^splitRow",restrict:"E",transclude:!0,scope:{name:"@",show:"@"},replace:!0,template:'<div class="resizable-panel" ng-transclude ng-style="{width: \'\'+(ratio*100)+\'%\'}" ng-show="show"></div>',controller:function($scope,$rootScope){return $scope.$watch("show",function(){return $scope.show=!!$scope.show,$scope.ctrl.equalCols(),$scope.ctrl.findLastCol(),setTimeout(function(){return $rootScope.$broadcast("panel_resized")})})},link:function(scope,elm,attrs,splitRowCtrl){return scope.themes=[],scope.div=elm,scope.ctrl=splitRowCtrl,scope.mouseover=!1,setTimeout(function(){return scope.show=!!scope.show,splitRowCtrl.addCol(scope)},0),elm.bind("mousemove",function(e){return e.originalEvent.caughtBy=scope.name,scope.mouseover?void 0:$rootScope.$broadcast("mousemoved",scope.name)}),scope.$on("mousemoved",function(e,name){return $timeout(function(){return scope.mouseover=name===scope.name})})}}}).directive("dragArea",function(){return{restrict:"E",replace:!0,template:'<div class="drag-area"></div>',scope:!1,link:function(scope,elm){return elm.bind("mousedown",function(e){return scope.ctrl.start_drag(scope,e)})}}})}.call(this),function(){"use strict";angular.module("DLApp").filter("indentHTML",function(){return function(html){var indent;if(html)return indent=function(html){var cl,i,ind,insert,k,n,op,open,str,_i;for(str=html,i=1,k=0,open=-1,insert=function(){return str=[str.slice(0,open),"(",Array(i).join(")"),str.slice(open)].join("")},ind=function(c){return str.indexOf(c,open+i+k+1)},n=_i=1;1e3>=_i;n=++_i){if(open=ind("<"),-1===open)return str;"/"===str.charAt(open+1)?(insert(),i--,k=1):(i++,insert(),k=0),op=ind("<"),cl=ind("/>"),cl>-1&&op>cl&&(k=1,i--)}},indent(html,1).replace(/\(/g,"\n").replace(/\)/g,"  ")}}).filter("md2html",function(){return function(md){return md&&md.replace(/\s*/,"")?markdown.toHTML(md):""}}).filter("shade2html",function(x2js){return function(Shade){var template,templateData;return templateData=x2js.xml2json(Shade),_.extend(templateData,{NodeHandlers:NodeHandlers}),(template=_.template($rootScope.shadeTemplate))(templateData)}}).filter("escapeHTML",function(){return function(html){return html&&html.replace(/\s*/,"")?html.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;"):""}}).filter("scopeCSS",function(){return function(css,prefix){var blacklist,doc,response,scope_selectors,styles;return doc=document.implementation.createHTMLDocument(""),styles=document.createElement("style"),styles.innerText=css,doc.body.appendChild(styles),blacklist=/(^| )(head|title|link|style|script)($| )/,response="",scope_selectors=function(rules){var contained_styles,cssText,i,line,mtch,n,prop_decl,prop_url_pairs,r,s,selector,selectors,splitter,url_content,url_selector,_i,_j,_k,_len,_len1,_ref,_ref1,_ref2,_results;if(rules.length){for(_results=[],i=_i=0,_ref=rules.length;_ref>=0?_ref>_i:_i>_ref;i=_ref>=0?++_i:--_i)if(rules[i].selectorText)if(selectors=rules[i].selectorText.split(", "),selector=function(){var _j,_len,_results1;for(_results1=[],_j=0,_len=selectors.length;_len>_j;_j++)s=selectors[_j],blacklist.test(s)||_results1.push(/(^| )(body|html)($| )/.test(s)?s.replace(/(body|html)/,prefix):""+prefix+" "+s);return _results1}().join(", ")){if(cssText="",/url\(\)/.test(rules[i].cssText)){n=0;for(r in rules)rules[r].selectorText===rules[i].selectorText&&parseInt(r)<i&&(n+=1);for(splitter=RegExp(rules[i].selectorText+"\\s*{"),contained_styles=css.split(splitter)[n+1].split("}")[0],prop_url_pairs={},_ref1=contained_styles.match(/\s*(.+?)\s*:.+?url\((.+?)\).*?;/g),_j=0,_len=_ref1.length;_len>_j;_j++)line=_ref1[_j],mtch=line.match(/\s*([\-\w]+)\s*:.+?url\((.+?)\).*?;/),url_selector=mtch[1].replace(/\s+/g,""),url_content=mtch[2].replace(/\s+/g,""),prop_url_pairs[url_selector]=url_content;for(cssText+=selector+" { ",_ref2=rules[i].cssText.match(/\{(.+)\}/)[1].split(";"),_k=0,_len1=_ref2.length;_len1>_k;_k++)prop_decl=_ref2[_k],~prop_decl.indexOf("url()")?(url_selector=prop_decl.match(/\s*(.+?)\s*:.+/)[1].replace(/\s+/g,""),url_content=prop_url_pairs[url_selector],url_content||"background-image"===url_selector&&(url_content=prop_url_pairs.background),prop_decl=prop_decl.replace("url()","url("+url_content+")"),cssText+=prop_decl+"; "):cssText+=prop_decl+"; ";cssText+=" } "}else rules[i].selectorText=selector,cssText=rules[i].cssText;_results.push(response+=cssText+"   ")}else _results.push(void 0);else _results.push("screen"===rules[i].media[0]?scope_selectors(rules[i].cssRules):void 0);return _results}},scope_selectors(styles.sheet.cssRules),response}}).filter("deSassify",function(){return function(css){return css.replace(/@media -sass-debug-info.*?\{(?:.*?\{.*?\})+.*?\}/g,"")}}).filter("prettifyCSS",function(){return function(css){return css.replace(/^\s+/g,"").replace(/\s*,\s*/g,", ").replace(/\s*{\s*/g," {\n    ").replace(/\s*;\s*/g,";\n    ").replace(/\*\//g,"*/\n").replace(/\n\n+/g,"\n").replace(/\s*}\s*/g,"\n}\n\n")}}).filter("prettifyHTML",function(){var closing,count_inline,indent,inline,tag_re;return indent=function(n,inline_count){return 0>=n?"":Array(n-inline_count+1).join("  ")},inline=function(tag){return"span"===tag||"a"===tag||"code"===tag||"i"===tag||"b"===tag||"em"===tag||"strong"===tag||"abbr"===tag||"img"===tag||"h1"===tag||"h2"===tag||"h3"===tag||"h4"===tag||"h5"===tag||"h6"===tag||"bdi"===tag||"bdo"===tag||"wbr"===tag||"kbd"===tag||"del"===tag||"ins"===tag||"s"===tag||"rt"===tag||"rp"===tag||"var"===tag||"time"===tag||"sub"===tag||"sup"===tag||"link"===tag||"title"===tag||"label"===tag||"input"===tag},closing=function(tag){return"area"===tag||"br"===tag||"col"===tag||"embed"===tag||"hr"===tag||"img"===tag||"input"===tag||"keygen"===tag||"link"===tag||"meta"===tag||"base"===tag||"param"===tag||"source"===tag||"track"===tag||"wbr"===tag},count_inline=function(stack){var t;return function(){var _i,_len,_results;for(_results=[],_i=0,_len=stack.length;_len>_i;_i++)t=stack[_i],inline(t)&&_results.push(t);return _results}().length},tag_re="<(?:(?:(\\w+)[^><]*?)|(?:\\/(\\w+)))>",tag_re=new RegExp(tag_re),tag_re.compile(tag_re),function(html){var i,inline_count,last_t,m,pretty_html,saved,stack,tag_name;for(saved=html,inline_count=0,stack=[],pretty_html="";html;)i=html.search(tag_re),i+1||(pretty_html+=html,html=""),m=html.match(tag_re),(tag_name=m[1])?inline(tag_name)?("\n"===pretty_html.charAt(pretty_html.length-1)&&(pretty_html+=indent(stack.length,inline_count)),pretty_html+=html.substr(0,i+m[0].length),stack.push(tag_name),inline_count+=1,html=html.substr(i+m[0].length)):closing(tag_name)?("\n"===pretty_html.charAt(pretty_html.length-1)&&(pretty_html+=indent(stack.length,inline_count)),pretty_html+=html.substr(0,i+m[0].length),html=html.substr(i+m[0].length)):(i&&"\n"===pretty_html.charAt(pretty_html.length-1)&&(pretty_html+=indent(stack.length,inline_count)),pretty_html+=""+html.substr(0,i),"\n"!==pretty_html.charAt(pretty_html.length-1)&&(pretty_html+="\n"),pretty_html+=indent(stack.length,inline_count)+m[0],stack.push(tag_name),pretty_html+="\n",html=html.substr(i+m[0].length)):(tag_name=m[2])?(last_t=stack.lastIndexOf(tag_name),last_t+1?inline(tag_name)?(inline_count-=1,stack.splice(last_t),pretty_html+=""+html.substr(0,i)+m[0],html=html.substr(i+m[0].length)):(i&&"\n"===pretty_html.charAt(pretty_html.length-1)&&(pretty_html+=indent(stack.length,inline_count)),stack.splice(last_t),inline_count=count_inline(stack),pretty_html+=""+html.substr(0,i)+("\n"===pretty_html.charAt(pretty_html.length-1)?"":"\n")+indent(stack.length,inline_count)+m[0],html=html.substr(i+m[0].length),"\n"!==html[0]&&(pretty_html+="\n")):(pretty_html+=""+html.substr(0,i+m[0].length),html=html.substr(i+m[0].length))):console.warn("UH OH: found a tag that's not an opening tag or a closing tag!?!?");return pretty_html}})}.call(this),angular.module("DLApp").service("graphService",function(){var div_name={Table:"#DLtable_wrapper",Graph:"svg"},graphState=function(theme,state){$(div_name[theme]).css("display",state)};this.deleteGraph=function(theme){$(div_name[theme]).remove()},this.hideGraph=function(theme){graphState(theme,"none")},this.showGraph=function(theme){graphState(theme,"")};var formatArrayObject=function(obj){var cases={number:function(value){return value.toFixed(2)},object:function(value){return formatArrayObject(value)}};return"{"+$.map(obj,function(value){return(cases[typeof value]||function(v){return v})(value)})+"}"};this.drawGraph={Table:function(_graph,div){if(0==$("#DLtable_wrapper").length&&_graph){var _v,data=JSON.parse(JSON.stringify(_graph.variables.variables));for(var key in data){var v=data[key];if(v.hasOwnProperty("expr"))for(var _key in v){var attr=v[_key];attr&&"object"==typeof attr&&"value"==_key?v[_key]=formatArrayObject(attr):"number"==typeof attr?v[_key]=attr.toFixed(2):"function"==typeof attr&&delete v[_key]}else delete data[key]}var tableData=[];$.each(data,function(index,value){data.hasOwnProperty(index)&&tableData.push([index].concat(_.toArray(value)))});for(var key in data){_v=data[key];break}var tableColumns=[];tableColumns.push({sTitle:"name",sClass:"center"});for(var attr in _v)_v.hasOwnProperty(attr)&&tableColumns.push({sTitle:attr,sClass:"center"});$(div).append('<table cellpadding ="0" cellspacing ="0" border="0" class = "display" id="DLtable"></table>'),$("#DLtable").dataTable({aaData:tableData,aoColumns:tableColumns})}},Graph:function(_graph,div){function ArrayObjectLookup(array,attr){for(var i=0;i<array.length;i++)if(array[i].name==attr)return i}function zoom(){svg.attr("transform","translate("+d3.event.translate+")scale("+d3.event.scale+")")}function renderViewed(color,src,trgt){lines.filter(function(){return d3.select(this).attr(src)==d3.select(g_elem).attr("index")}).style("stroke",color).attr("viewed",1).each(function(){var that=this;circles.filter(function(){return d3.select(this).attr("index")==d3.select(that).attr(trgt)}).attr("viewed",1).selectAll("circle").style("stroke",color)})}function renderFocused(src,trgt,_that){var x="src"==src?1:3,dep_radius=height/16,nodes_in_wid=parseInt(width/dep_radius*2/node_to_padding_ratio),matches=0;lines.filter(function(){return d3.select(this).attr(src)==d3.select(_that).attr("index")&&matches++,d3.select(this).attr(src)==d3.select(_that).attr("index")}).attr("focused",1).attr("x1",function(){return width/2}).attr("y1",function(){return height/2}).attr("x2",function(d,i){return width/2-(matches>nodes_in_wid?width/2-4*dep_radius/2:4*dep_radius/2*(matches-1))+i%nodes_in_wid*dep_radius*4}).attr("y2",function(d,i){return x*height/4-parseInt(i/nodes_in_wid)*dep_radius*4}).each(function(d,i){var that=this;circles.filter(function(){return d3.select(this).attr("index")==d3.select(that).attr(trgt)}).attr("focused",1).attr("transform",function(){return d.xf=width/2-(matches>nodes_in_wid?width/2-4*dep_radius/2:4*dep_radius/2*(matches-1))+i%nodes_in_wid*dep_radius*4,d.yf=x*height/4-parseInt(i/nodes_in_wid)*dep_radius*4,"translate("+d.xf+","+d.yf+")"}).selectAll("circle").attr("r",dep_radius)})}if(_graph){d3.select("svg").remove();var data=_.cloneDeep(_graph.variables),graph={nodes:[],links:[]};for(var v in data.variables){var _v=data.variables[v];_v.hasOwnProperty("expr")&&(_v.name=v,graph.nodes.push(_v))}$.each(data.edges,function(index){graph.links[index]={source:ArrayObjectLookup(graph.nodes,this[0]),target:ArrayObjectLookup(graph.nodes,this[1])}}),d3.selection.prototype.moveToFront=function(){return this.each(function(){this.parentNode.appendChild(this)})};for(var g_state="",canvas=$(div);!canvas.width()||!canvas.height();)canvas=canvas.parent();var width=canvas.width(),height=canvas.height(),svg=d3.select(div).append("svg").attr("width",width).attr("height",height).call(d3.behavior.zoom().scaleExtent([.25,2]).on("zoom",zoom)).on("dblclick.zoom",null).append("g"),width_padding=20,height_padding=20,div_area=(width-width_padding)*(height-height_padding),num_nodes=graph.nodes.length,node_area=div_area/(num_nodes+num_nodes%2),node_to_padding_ratio=.5,node_dia_inc_pad=Math.sqrt(node_area),node_radius_wo_pad=node_dia_inc_pad/2*node_to_padding_ratio,nodes_in_width=parseInt(width/node_dia_inc_pad)||1,nodes_in_height=parseInt(height/node_dia_inc_pad)||1,xScale=d3.scale.linear().domain([0,nodes_in_width]).range([width_padding+node_radius_wo_pad,width-width_padding-node_radius_wo_pad]),yScale=d3.scale.linear().domain([0,nodes_in_height]).range([height_padding+node_radius_wo_pad,height-height_padding-node_radius_wo_pad]),getX=function(index){return xScale(index%nodes_in_width)},getY=function(index){return yScale(parseInt(index/nodes_in_width))},lines=svg.append("g").attr("class","line").selectAll("line").data(graph.links).enter().append("line").attr("x1",function(d){return getX(d.source)}).attr("y1",function(d){return getY(parseInt(d.source))}).attr("x2",function(d){return getX(d.target)}).attr("y2",function(d){return getY(d.target)}).attr("src",function(d){return d.source}).attr("trgt",function(d){return d.target}).attr("viewed",function(){return 0}).attr("focused",function(){return 0}).style("stroke","grey"),circles=svg.append("g").attr("class","nodes").selectAll("circle").data(graph.nodes).enter().append("g").attr("transform",function(d,i){return d.x=getX(i),d.y=getY(i),"translate("+d.x+","+d.y+")"}).attr("name",function(d){return d.name}).attr("viewed",0).attr("focused",0).attr("index",function(d,i){return i});circles.append("circle").style("stroke","gray").style("fill","white").attr("r",node_radius_wo_pad).on("mouseover",function(){if(g_elem=this.parentNode,1==d3.select(g_elem).attr("focused")||"focus"!=g_state){if("focus"==g_state)return void d3.select(this).style("fill","aliceblue");d3.select(g_elem).attr("viewed",1);renderViewed("red","src","trgt"),renderViewed("green","trgt","src"),lines.filter(function(){return 0==d3.select(this).attr("viewed")}).transition().style("opacity",0);var toChange=circles.filter(function(){return 0==d3.select(this).attr("viewed")});toChange.selectAll("circle").transition().style("opacity",.2),toChange.selectAll("text").transition().style("opacity",.2),d3.select(this).style("fill","aliceblue")}}).on("mouseout",function(){if("focus"==g_state){lines.filter(function(){return 1==d3.select(this).attr("focused")}).style("stroke","grey").attr("viewed",0).transition().style("opacity",1);var toChange=circles.filter(function(){return 1==d3.select(this).attr("focused")}).attr("viewed",0);toChange.selectAll("circle").transition().style("opacity",1),toChange.selectAll("text").transition().style("opacity",1),d3.select(this).style("fill","white")}else lines.style("stroke","grey").attr("viewed",0).transition().style("opacity",1),circles.attr("viewed",0).selectAll("circle").style("stroke","grey").transition().style("opacity",1),circles.selectAll("text").transition().style("opacity",1),d3.select(this).style("fill","white")}).on("dblclick",function(){if("focus"==g_state)return circles.attr("transform",function(d){return"translate("+d.x+","+d.y+")"}).attr("viewed",function(){return 0}).attr("focused",function(){return 0}).selectAll("circle").attr("r",node_radius_wo_pad),lines.attr("x1",function(d){return getX(d.source)}).attr("y1",function(d){return getY(d.source)}).attr("x2",function(d){return getX(d.target)}).attr("y2",function(d){return getY(d.target)}),lines.attr("viewed",function(){return 0}).attr("focused",function(){return 0}).style("stroke","grey"),void(g_state="");g_state="focus";var node=d3.select(this.parentNode);node.moveToFront(),node.attr("focused",1).attr("transform","translate("+width/2+","+height/2+")").selectAll("circle").attr("r",height/8);var that=this.parentNode;renderFocused("src","trgt",that),renderFocused("trgt","src",that),lines.filter(function(){return 1!=d3.select(this).attr("focused")}).transition().style("opacity",0);var toChange=circles.filter(function(){return 1!=d3.select(this).attr("focused")});toChange.selectAll("circle").transition().style("opacity",0),toChange.selectAll("text").transition().style("opacity",0)}),circles.append("text").attr("text-anchor","middle").text(function(d){return d.name}).attr("font-family","sans-serif").attr("font-size","50px").attr("y",10)}}}}),function(){angular.module("DLApp").service("Graph",function($http,$window){return{getGraph:function(DLcode,style,callback){return $window.DL.createGraph?callback($window.DL.createGraph(DLcode)):$http.post("/sendDL",{DLcode:DLcode,Shade:style}).success(function(data){return callback($window.DL.Graph(data))})},getTokens:function(DLcode){return $window.DL.tokens(DLcode)},getFunctions:function(){return $window.DL.builtInFunctions}}})}.call(this),function(){angular.module("DLApp").service("x2js",function(){var x2js;return x2js=new X2JS,this.xml2json=function(XML){return x2js.xml_str2json(XML)},this})}.call(this);
//# sourceMappingURL=script.min.map