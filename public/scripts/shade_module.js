// Generated by CoffeeScript 1.7.1
(function() {
  angular.module('ShadeApp', ['ngGrid']).directive('testDl', function() {
    return {
      restrict: 'E',
      replace: true,
      scope: true,
      templateUrl: 'directive-templates/testdl.html',
      link: function(scope, elm, attrs) {
        scope.variable = attrs.vdl;
        return scope.setDLVar = function() {
          return scope.graph.set(scope.variable, Number(scope.toSet));
        };
      }
    };
  }).directive('numEdit', function() {
    return {
      restrict: 'E',
      replace: true,
      scope: true,
      template: function(elm, attr) {
        return '<div><input type="text" ng-model="vars[&quot;' + attr.vtext + '&quot;].model"></div>';
      }
    };
  }).directive('dropDown', function($compile) {
    return {
      restrict: 'E',
      scope: true,
      link: function(scope, elm, attr) {
        var header, items;
        header = attr.header.split('|');
        items = attr.items.split(',').map(function(elm) {
          return elm.split('|');
        });
        scope.myData = items.map(function(elm) {
          return elm.reduce((function(obj, el, ind) {
            obj[header[ind]] = el;
            return obj;
          }), {});
        });
        scope.gridOptions = {
          data: 'myData'
        };
        elm.html('<div class="gridStyle" ng-grid="gridOptions"></div>');
        return $compile(elm.contents())(scope);
      }
    };
  }).directive('renderPanel', function($compile, shadeTemplate) {
    return {
      restrict: 'E',
      scope: {
        vars: '=',
        graph: '=',
        styles: '='
      },
      link: function(scope, elm) {
        return scope.$watch('styles', function(shade) {
          scope.data = shadeTemplate.toHTML(shade);
          elm.html('<style>' + scope.data.styles + '</style>' + scope.data.body);
          return $compile(elm.contents())(scope);
        });
      }
    };
  }).directive('prettyPrintPanel', function($filter, shadeTemplate) {
    return {
      restrict: 'A',
      replace: true,
      template: '<div class="pp-panel"></div>',
      link: function(scope, elm, attrs) {
        return scope.$watch(attrs.prettyPrintPanel, function(shade) {
          var code, pre, raw_html;
          raw_html = $filter('indentHTML')(shadeTemplate.toHTML(shade).body);
          pre = angular.element('<pre class="prettyprint lang-html" style="font-size:0.75em"></pre>');
          code = angular.element('<code></code>');
          code.html($filter('escapeHTML')(raw_html));
          pre.append(code);
          elm.html(pre);
          return prettyPrint();
        });
      },
      controller: function($scope, $http) {
        var themes;
        $scope.themes = themes = {
          list: ['google-code-light', 'solarized-dark', 'solarized-light', 'sons-of-obsidian-dark', 'tomorrow-night-blue', 'tomorrow-night-dark', 'tomorrow-night-light', 'tomorrow-night-eighties'],
          selected: 'google-code-light'
        };
        return $scope.$watch('themes.selected', function(theme_name) {
          var url;
          url = "styles/gprettify/" + theme_name + ".css";
          return $http.get(url).then(function(response) {
            return themes.css = response.data;
          });
        });
      }
    };
  }).service('shadeTemplate', function($http, x2js, ShadeParser, ShadeDictionary) {
    var template;
    template = function() {};
    $http.get('/scripts/ng_template_shd.js').success(function(data) {
      _.templateSettings.variable = "shd";
      return template = _.template(data);
    }).error(function() {
      return console.log("could not retrieve shade template");
    });
    this.toHTML = function(shade) {
      var parsed;
      parsed = ShadeParser.parse(x2js.xml2json(shade));
      _.extend(parsed, ShadeDictionary);
      return {
        'body': template(parsed),
        'styles': (parsed || {}).styles
      };
    };
    return this;
  });

}).call(this);

//# sourceMappingURL=shade_module.map
